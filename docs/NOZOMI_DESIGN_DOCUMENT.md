# Nozomi - çµ±åˆå‹AIé‘‘å®šã‚·ã‚¹ãƒ†ãƒ  é–‹ç™ºè¨­è¨ˆæ›¸

**Version:** 1.0.0
**Date:** 2026-01-03
**Status:** ç¢ºå®šç‰ˆ

---

## ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#1-ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ](#2-ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ)
3. [6å¤§å è¡“ãƒ­ã‚¸ãƒƒã‚¯ä»•æ§˜](#3-6å¤§å è¡“ãƒ­ã‚¸ãƒƒã‚¯ä»•æ§˜)
4. [éœŠè¦–ã‚·ã‚¹ãƒ†ãƒ ä»•æ§˜](#4-éœŠè¦–ã‚·ã‚¹ãƒ†ãƒ ä»•æ§˜)
5. [å‡ºåŠ›ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³](#5-å‡ºåŠ›ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³)
6. [ã‚¢ãƒƒãƒ—ã‚»ãƒ«èª˜å°æ©Ÿæ§‹](#6-ã‚¢ãƒƒãƒ—ã‚»ãƒ«èª˜å°æ©Ÿæ§‹)
7. [æŠ€è¡“ä»•æ§˜](#7-æŠ€è¡“ä»•æ§˜)
8. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼](#8-ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼)
9. [å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³](#9-å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³)

---

## 1. ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå
**Nozomiï¼ˆã®ãã¿ / å¸Œï¼‰** - çµ±åˆå‹AIé‘‘å®šã‚·ã‚¹ãƒ†ãƒ 

### 1.2 ç›®çš„
è¤‡æ•°ã®å è¡“ä½“ç³»ã‚’çµ±åˆã—ã€AIæŠ€è¡“ã¨çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€é«˜ç²¾åº¦ã‹ã¤ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸé‘‘å®šã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã™ã‚‹ã€‚6000æ–‡å­—ã®è©³ç´°ãªé‘‘å®šçµæœã¨ã€3æ®µéšã®ã‚¢ãƒƒãƒ—ã‚»ãƒ«èª˜å°ã«ã‚ˆã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦ã¨åç›Šæ€§ã‚’ä¸¡ç«‹ã™ã‚‹ã€‚

### 1.3 ä¸»è¦æ©Ÿèƒ½
- **6å¤§å è¡“çµ±åˆã‚¨ãƒ³ã‚¸ãƒ³**: è¥¿æ´‹å æ˜Ÿè¡“ã€å››æŸ±æ¨å‘½ã€ã‚¿ãƒ­ãƒƒãƒˆã€æ•°ç§˜è¡“ã€ä¹æ˜Ÿæ°—å­¦ã€å§“ååˆ¤æ–­
- **éœŠè¦–AIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**: ç›´æ„Ÿçš„æ´å¯Ÿã‚’æ¨¡å€£ã™ã‚‹æ·±å±¤å­¦ç¿’ãƒ¢ãƒ‡ãƒ«
- **6000æ–‡å­—è©³ç´°é‘‘å®š**: æ§‹é€ åŒ–ã•ã‚ŒãŸåŒ…æ‹¬çš„ãªé‘‘å®šãƒ¬ãƒãƒ¼ãƒˆ
- **3æ®µéšã‚¢ãƒƒãƒ—ã‚»ãƒ«**: ç„¡æ–™â†’åŸºæœ¬â†’ãƒ—ãƒ¬ãƒŸã‚¢ãƒ â†’VIPé‘‘å®šã¸ã®èª˜å°

### 1.4 ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼
- **ä¸€æ¬¡**: 20-50ä»£å¥³æ€§ã€è‡ªå·±ç†è§£ãƒ»äººç”Ÿç›¸è«‡ã‚’æ±‚ã‚ã‚‹å±¤
- **äºŒæ¬¡**: çµŒå–¶è€…ãƒ»æ„æ€æ±ºå®šè€…ï¼ˆãƒ“ã‚¸ãƒã‚¹å ã„éœ€è¦ï¼‰
- **ä¸‰æ¬¡**: ã‚«ãƒƒãƒ—ãƒ«ãƒ»å®¶æ—ï¼ˆç›¸æ€§è¨ºæ–­éœ€è¦ï¼‰

---

## 2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### 2.1 ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Frontend Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Web UI       â”‚  â”‚ Mobile App   â”‚  â”‚ Admin Panel  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      API Gateway Layer                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ REST API     â”‚  â”‚ GraphQL      â”‚  â”‚ WebSocket    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Core Divination Engine                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          Orchestration Controller                     â”‚  â”‚
â”‚  â”‚  - Input validation & normalization                   â”‚  â”‚
â”‚  â”‚  - Multi-divination coordination                      â”‚  â”‚
â”‚  â”‚  - Result synthesis & weighting                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚                                                     â”‚      â”‚
â”‚  â–¼                                                     â–¼      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ 6å¤§å è¡“ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«  â”‚                    â”‚  éœŠè¦–AIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«  â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 1. è¥¿æ´‹å æ˜Ÿè¡“     â”‚                    â”‚ - Transformer    â”‚â”‚
â”‚  â”‚ 2. å››æŸ±æ¨å‘½       â”‚                    â”‚ - Pattern Match  â”‚â”‚
â”‚  â”‚ 3. ã‚¿ãƒ­ãƒƒãƒˆ       â”‚                    â”‚ - Intuition Gen  â”‚â”‚
â”‚  â”‚ 4. æ•°ç§˜è¡“         â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”‚ 5. ä¹æ˜Ÿæ°—å­¦       â”‚                                         â”‚
â”‚  â”‚ 6. å§“ååˆ¤æ–­       â”‚                                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â”‚                            â”‚                                  â”‚
â”‚                            â–¼                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         Output Generation Engine (6000æ–‡å­—)           â”‚   â”‚
â”‚  â”‚  - Template selection & customization                 â”‚   â”‚
â”‚  â”‚  - Natural language generation (Claude API)           â”‚   â”‚
â”‚  â”‚  - Structure: Header + Analysis + Advice + Upsell     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Upsell Guidance Layer                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Type 1:      â”‚  â”‚ Type 2:      â”‚  â”‚ Type 3:      â”‚      â”‚
â”‚  â”‚ å³æ™‚è©³ç´°é‘‘å®š  â”‚  â”‚ æœˆé¡ã‚µãƒ–ã‚¹ã‚¯  â”‚  â”‚ å€‹åˆ¥ç›¸è«‡äºˆç´„  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Data Layer                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ User DB      â”‚  â”‚ Reading DB   â”‚  â”‚ Analytics DB â”‚      â”‚
â”‚  â”‚ (PostgreSQL) â”‚  â”‚ (MongoDB)    â”‚  â”‚ (ClickHouse) â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

| Layer | Technology | Reason |
|-------|-----------|--------|
| **Frontend** | Next.js 14 + TypeScript | SSR, SEOæœ€é©åŒ–ã€å‹å®‰å…¨æ€§ |
| **API** | Node.js + Express | é«˜é€Ÿã€è±Šå¯Œãªã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ  |
| **AI Engine** | Claude Sonnet 4.5 API | é«˜ç²¾åº¦ãªè‡ªç„¶è¨€èªç”Ÿæˆ |
| **Divination Logic** | Python 3.11 | æ•°å€¤è¨ˆç®—ã€å¤©æ–‡è¨ˆç®—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå……å®Ÿ |
| **Database** | PostgreSQL + MongoDB | ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ« + ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½µç”¨ |
| **Cache** | Redis | ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã€é«˜é€Ÿã‚¢ã‚¯ã‚»ã‚¹ |
| **Deploy** | Docker + Kubernetes | ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã€ç’°å¢ƒä¸€è²«æ€§ |

---

## 3. 6å¤§å è¡“ãƒ­ã‚¸ãƒƒã‚¯ä»•æ§˜

### 3.1 è¥¿æ´‹å æ˜Ÿè¡“ (Western Astrology)

#### 3.1.1 å…¥åŠ›ãƒ‡ãƒ¼ã‚¿
- ç”Ÿå¹´æœˆæ—¥ï¼ˆYYYY-MM-DDï¼‰
- å‡ºç”Ÿæ™‚åˆ»ï¼ˆHH:MMï¼‰
- å‡ºç”Ÿåœ°ï¼ˆç·¯åº¦ãƒ»çµŒåº¦ï¼‰

#### 3.1.2 è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
```python
# ä¸»è¦è¨ˆç®—é …ç›®
1. ãƒ›ãƒ­ã‚¹ã‚³ãƒ¼ãƒ—ä½œæˆ
   - 10å¤©ä½“ã®ä½ç½®è¨ˆç®—ï¼ˆå¤ªé™½ã€æœˆã€æ°´æ˜Ÿã€é‡‘æ˜Ÿã€ç«æ˜Ÿã€æœ¨æ˜Ÿã€åœŸæ˜Ÿã€å¤©ç‹æ˜Ÿã€æµ·ç‹æ˜Ÿã€å†¥ç‹æ˜Ÿï¼‰
   - 12ãƒã‚¦ã‚¹ã®å¢ƒç•Œç·šï¼ˆã‚¢ã‚»ãƒ³ãƒ€ãƒ³ãƒˆã€MCã€ãƒ‡ã‚£ã‚»ãƒ³ãƒ€ãƒ³ãƒˆã€ICï¼‰
   - ã‚¢ã‚¹ãƒšã‚¯ãƒˆï¼ˆ0Â°, 60Â°, 90Â°, 120Â°, 180Â°ï¼‰

2. ã‚µã‚¤ãƒ³ï¼ˆæ˜Ÿåº§ï¼‰åˆ†æ
   - å¤ªé™½æ˜Ÿåº§ï¼ˆåŸºæœ¬æ€§æ ¼ï¼‰
   - æœˆæ˜Ÿåº§ï¼ˆæ„Ÿæƒ…ãƒ»å†…é¢ï¼‰
   - ã‚¢ã‚»ãƒ³ãƒ€ãƒ³ãƒˆæ˜Ÿåº§ï¼ˆå¤–è¦‹ãƒ»ç¬¬ä¸€å°è±¡ï¼‰

3. ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆãƒ»ã‚¯ã‚ªãƒªãƒ†ã‚£åˆ†æ
   - ç«ãƒ»åœ°ãƒ»é¢¨ãƒ»æ°´ã®é…åˆ†
   - æ´»å‹•ãƒ»ä¸å‹•ãƒ»æŸ”è»Ÿã®é…åˆ†

4. ç¾åœ¨ã®ãƒˆãƒ©ãƒ³ã‚¸ãƒƒãƒˆï¼ˆé‹è¡Œï¼‰
   - ç¾åœ¨ã®å¤©ä½“ä½ç½® vs å‡ºç”Ÿå›³
   - é‡è¦ãªã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¤œå‡º
```

#### 3.1.3 ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- `swisseph` (Swiss Ephemeris) - é«˜ç²¾åº¦å¤©ä½“è¨ˆç®—
- `pytz` - ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å‡¦ç†

#### 3.1.4 å‡ºåŠ›å½¢å¼
```json
{
  "astrology": {
    "sun_sign": "ç‰¡ç¾Šåº§",
    "moon_sign": "èŸ¹åº§",
    "ascendant": "ç…å­åº§",
    "planets": {
      "sun": {"sign": "ç‰¡ç¾Šåº§", "house": 9, "degree": 15.23},
      "moon": {"sign": "èŸ¹åº§", "house": 12, "degree": 8.45},
      // ...
    },
    "aspects": [
      {"planet1": "sun", "planet2": "mars", "aspect": "trine", "orb": 2.3}
    ],
    "elements": {"fire": 4, "earth": 2, "air": 3, "water": 1},
    "qualities": {"cardinal": 3, "fixed": 4, "mutable": 3},
    "interpretation": {
      "personality": "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã«å„ªã‚Œã€æƒ…ç†±çš„...",
      "strength": "æ±ºæ–­åŠ›ã€è¡Œå‹•åŠ›",
      "challenge": "è¡å‹•æ€§ã€çŸ­æ°—",
      "current_transit": "æœ¨æ˜ŸãŒ10ãƒã‚¦ã‚¹ã‚’é€šéä¸­..."
    }
  }
}
```

### 3.2 å››æŸ±æ¨å‘½ (Four Pillars of Destiny)

#### 3.2.1 å…¥åŠ›ãƒ‡ãƒ¼ã‚¿
- ç”Ÿå¹´æœˆæ—¥
- å‡ºç”Ÿæ™‚åˆ»
- æ€§åˆ¥

#### 3.2.2 è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
```python
# ä¸»è¦è¨ˆç®—é …ç›®
1. å››æŸ±ï¼ˆå¹´æŸ±ãƒ»æœˆæŸ±ãƒ»æ—¥æŸ±ãƒ»æ™‚æŸ±ï¼‰ç®—å‡º
   - å„æŸ±ã®å¤©å¹²ãƒ»åœ°æ”¯
   - è”µå¹²ã®æŠ½å‡º
   - é€šå¤‰æ˜Ÿã®æ±ºå®š

2. äº”è¡Œãƒãƒ©ãƒ³ã‚¹åˆ†æ
   - æœ¨ãƒ»ç«ãƒ»åœŸãƒ»é‡‘ãƒ»æ°´ã®é…åˆ†
   - å¼·å¼±åˆ¤å®š
   - ç”¨ç¥ãƒ»å¿Œç¥ã®ç‰¹å®š

3. å¤§é‹ãƒ»å¹´é‹ã®è¨ˆç®—
   - 10å¹´å‘¨æœŸã®å¤§é‹
   - ç¾åœ¨ã®é‹å‹¢æœŸ
   - å‰å‡¶åˆ¤æ–­

4. åäºŒé‹æ˜Ÿãƒ»ç¥æ®ºã®åˆ¤å®š
   - é•·ç”Ÿãƒ»æ²æµ´ãƒ»å† å¸¯ãƒ»å»ºç¦„ãƒ»å¸æ—ºãƒ»è¡°ãƒ»ç—…ãƒ»æ­»ãƒ»å¢“ãƒ»çµ¶ãƒ»èƒãƒ»é¤Š
   - å¤©ä¹™è²´äººã€æ–‡æ˜Œè²´äººãªã©
```

#### 3.2.3 å‡ºåŠ›å½¢å¼
```json
{
  "four_pillars": {
    "year": {"å¤©å¹²": "ç”²", "åœ°æ”¯": "å­", "é€šå¤‰æ˜Ÿ": "åå°"},
    "month": {"å¤©å¹²": "ä¸™", "åœ°æ”¯": "å¯…", "é€šå¤‰æ˜Ÿ": "é£Ÿç¥"},
    "day": {"å¤©å¹²": "æˆŠ", "åœ°æ”¯": "åˆ", "é€šå¤‰æ˜Ÿ": "æ¯”è‚©"},
    "hour": {"å¤©å¹²": "åºš", "åœ°æ”¯": "ç”³", "é€šå¤‰æ˜Ÿ": "åè²¡"},
    "elements": {"æœ¨": 2, "ç«": 3, "åœŸ": 2, "é‡‘": 2, "æ°´": 1},
    "strength": "èº«æ—º",
    "favorable_god": "é‡‘ãƒ»æ°´",
    "unfavorable_god": "ç«ãƒ»æœ¨",
    "fortune_cycle": {
      "current_age": 35,
      "period": "å£¬æˆŒ",
      "evaluation": "å‰"
    },
    "interpretation": {
      "character": "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ãŒã‚ã‚Šã€å‰µé€ æ€§è±Šã‹...",
      "career": "çµŒå–¶è€…ã€ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼å‘ã",
      "relationships": "æƒ…ç†±çš„ã§é¢å€’è¦‹ãŒè‰¯ã„",
      "health": "æ¶ˆåŒ–å™¨ç³»ã«æ³¨æ„",
      "advice": "ä»Šå¹´ã¯é‡‘é‹ã«æµã¾ã‚Œã‚‹..."
    }
  }
}
```

### 3.3 ã‚¿ãƒ­ãƒƒãƒˆ (Tarot)

#### 3.3.1 ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ç¨®é¡
1. **ãƒ¯ãƒ³ã‚ªãƒ©ã‚¯ãƒ«**: ä»Šæ—¥ã®é‹å‹¢
2. **ã‚¹ãƒªãƒ¼ã‚«ãƒ¼ãƒ‰**: éå»ãƒ»ç¾åœ¨ãƒ»æœªæ¥
3. **ã‚±ãƒ«ãƒˆåå­—**: ç·åˆé‹å‹¢ï¼ˆè©³ç´°é‘‘å®šæ™‚ï¼‰

#### 3.3.2 è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
```python
# æ“¬ä¼¼ãƒ©ãƒ³ãƒ€ãƒ é¸æŠï¼ˆã‚·ãƒ¼ãƒ‰å€¤: ãƒ¦ãƒ¼ã‚¶ãƒ¼ID + ç”Ÿå¹´æœˆæ—¥ + è³ªå•ãƒãƒƒã‚·ãƒ¥ï¼‰
import hashlib
import random

def draw_cards(user_data, question, num_cards=3):
    seed_string = f"{user_data['user_id']}{user_data['birth_date']}{question}"
    seed = int(hashlib.sha256(seed_string.encode()).hexdigest(), 16) % (10 ** 8)
    random.seed(seed)

    deck = list(range(78))  # 0-21: Major Arcana, 22-77: Minor Arcana
    drawn = random.sample(deck, num_cards)
    orientations = [random.choice(['upright', 'reversed']) for _ in drawn]

    return [(card, orientation) for card, orientation in zip(drawn, orientations)]
```

#### 3.3.3 ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
```json
{
  "0": {
    "name": "æ„šè€…",
    "name_en": "The Fool",
    "arcana": "major",
    "upright": {
      "keywords": ["æ–°ã—ã„å§‹ã¾ã‚Š", "è‡ªç”±", "å†’é™º"],
      "meaning": "ç´”ç²‹ãªå¿ƒã§æ–°ãŸãªæ—…ç«‹ã¡ã‚’..."
    },
    "reversed": {
      "keywords": ["ç„¡è¬€", "è»½ç‡", "ç„¡è¨ˆç”»"],
      "meaning": "æ…é‡ã•ã‚’æ¬ ã„ãŸè¡Œå‹•ã«æ³¨æ„..."
    }
  }
  // ... 78æšåˆ†
}
```

### 3.4 æ•°ç§˜è¡“ (Numerology)

#### 3.4.1 è¨ˆç®—é …ç›®
1. **ãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ãƒŠãƒ³ãƒãƒ¼**: ç”Ÿå¹´æœˆæ—¥ã®ç·å’Œ
2. **ãƒ‡ã‚£ã‚¹ãƒ†ã‚£ãƒ‹ãƒ¼ãƒŠãƒ³ãƒãƒ¼**: å§“åã®ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆæ•°å€¤åŒ–
3. **ã‚½ã‚¦ãƒ«ãƒŠãƒ³ãƒãƒ¼**: æ¯éŸ³ã®æ•°å€¤
4. **ãƒ‘ãƒ¼ã‚½ãƒŠãƒªãƒ†ã‚£ãƒŠãƒ³ãƒãƒ¼**: å­éŸ³ã®æ•°å€¤

#### 3.4.2 è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
```python
def calculate_life_path(birth_date):
    # ä¾‹: 1990-03-25 â†’ 1+9+9+0+0+3+2+5 = 29 â†’ 2+9 = 11 (ãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼)
    digits = [int(d) for d in birth_date.replace('-', '')]
    total = sum(digits)

    # ãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ (11, 22, 33) ã¯ç´„åˆ†ã—ãªã„
    while total > 9 and total not in [11, 22, 33]:
        total = sum(int(d) for d in str(total))

    return total

def calculate_destiny(full_name):
    # A=1, B=2, ..., Z=26
    alphabet_values = {chr(i): i - 64 for i in range(65, 91)}

    name_clean = full_name.upper().replace(' ', '')
    total = sum(alphabet_values.get(char, 0) for char in name_clean)

    while total > 9 and total not in [11, 22, 33]:
        total = sum(int(d) for d in str(total))

    return total
```

#### 3.4.3 æ•°å­—ã®æ„å‘³
```json
{
  "1": {"keyword": "ãƒªãƒ¼ãƒ€ãƒ¼", "trait": "ç‹¬ç«‹å¿ƒã€å‰µé€ æ€§ã€è‡ªä¿¡"},
  "2": {"keyword": "å”èª¿è€…", "trait": "å”åŠ›ã€èª¿å’Œã€æ„Ÿå—æ€§"},
  "3": {"keyword": "è¡¨ç¾è€…", "trait": "å‰µé€ æ€§ã€ç¤¾äº¤æ€§ã€æ¥½è¦³æ€§"},
  "4": {"keyword": "å»ºè¨­è€…", "trait": "å®‰å®šã€å®Ÿå‹™çš„ã€èª å®Ÿ"},
  "5": {"keyword": "å†’é™ºå®¶", "trait": "è‡ªç”±ã€å¤‰åŒ–ã€å¥½å¥‡å¿ƒ"},
  "6": {"keyword": "é¤Šè‚²è€…", "trait": "è²¬ä»»æ„Ÿã€æ„›æƒ…ã€å®¶åº­çš„"},
  "7": {"keyword": "æ¢æ±‚è€…", "trait": "åˆ†æåŠ›ã€ç²¾ç¥æ€§ã€å†…çœ"},
  "8": {"keyword": "å®ŸåŠ›è€…", "trait": "é‡å¿ƒã€æ¨©åŠ›ã€ç‰©è³ªçš„æˆåŠŸ"},
  "9": {"keyword": "å®Œæˆè€…", "trait": "åšæ„›ã€ç†æƒ³ä¸»ç¾©ã€å®Œæˆ"},
  "11": {"keyword": "éœŠæ„Ÿè€…", "trait": "ç›´æ„Ÿã€ã‚¤ãƒ³ã‚¹ãƒ”ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€å•“ç¤º"},
  "22": {"keyword": "ãƒã‚¹ã‚¿ãƒ¼ãƒ“ãƒ«ãƒ€ãƒ¼", "trait": "å¤§ããªãƒ“ã‚¸ãƒ§ãƒ³ã€å®Ÿç¾åŠ›"},
  "33": {"keyword": "ãƒã‚¹ã‚¿ãƒ¼ãƒ†ã‚£ãƒ¼ãƒãƒ£ãƒ¼", "trait": "ç„¡æ¡ä»¶ã®æ„›ã€å¥‰ä»•"}
}
```

### 3.5 ä¹æ˜Ÿæ°—å­¦ (Nine Star Ki)

#### 3.5.1 è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
```python
# æœ¬å‘½æ˜Ÿã®ç®—å‡ºï¼ˆç”Ÿã¾ã‚Œå¹´ã‹ã‚‰ï¼‰
def calculate_honmei_star(birth_year):
    # ç°¡æ˜“è¨ˆç®—å¼ï¼ˆå®Ÿéš›ã¯æ—§æš¦ãƒ»ç¯€åˆ†è€ƒæ…®å¿…è¦ï¼‰
    base = 11 - (birth_year % 9)
    if base == 10:
        base = 1
    return base

# æœˆå‘½æ˜Ÿã®ç®—å‡º
def calculate_gekkei_star(birth_month, honmei_star):
    # æœˆç›¤ã®è¨ˆç®—
    month_base = [8, 7, 6, 5, 4, 3, 2, 1, 9]
    return month_base[birth_month - 1]

# å‰æ–¹ä½ã®åˆ¤å®š
def calculate_favorable_direction(honmei_star, year, month):
    # å¹´ãƒ»æœˆã®ä¹æ˜Ÿã¨æœ¬å‘½æ˜Ÿã®é–¢ä¿‚ã‹ã‚‰å‰æ–¹ä½ã‚’ç®—å‡º
    # å®Ÿè£…: ç›¸ç”Ÿãƒ»æ¯”å’Œã®æ–¹ä½ãŒå‰
    favorable = []
    # ... ãƒ­ã‚¸ãƒƒã‚¯çœç•¥
    return favorable
```

#### 3.5.2 ä¹æ˜Ÿã®ç‰¹æ€§
```json
{
  "1": {"name": "ä¸€ç™½æ°´æ˜Ÿ", "element": "æ°´", "trait": "æŸ”è»Ÿæ€§ã€æ€è€ƒåŠ›"},
  "2": {"name": "äºŒé»’åœŸæ˜Ÿ", "element": "åœŸ", "trait": "çŒ®èº«çš„ã€å‹¤å‹‰"},
  "3": {"name": "ä¸‰ç¢§æœ¨æ˜Ÿ", "element": "æœ¨", "trait": "è¡Œå‹•åŠ›ã€ç™ºå±•"},
  "4": {"name": "å››ç·‘æœ¨æ˜Ÿ", "element": "æœ¨", "trait": "ç¤¾äº¤æ€§ã€èª¿å’Œ"},
  "5": {"name": "äº”é»„åœŸæ˜Ÿ", "element": "åœŸ", "trait": "å¼·é‹ã€å¸ç‹"},
  "6": {"name": "å…­ç™½é‡‘æ˜Ÿ", "element": "é‡‘", "trait": "å®Œç’§ä¸»ç¾©ã€æ°—å“"},
  "7": {"name": "ä¸ƒèµ¤é‡‘æ˜Ÿ", "element": "é‡‘", "trait": "ç¤¾äº¤çš„ã€é‡‘é‹"},
  "8": {"name": "å…«ç™½åœŸæ˜Ÿ", "element": "åœŸ", "trait": "å¤‰é©ã€è“„è²¡"},
  "9": {"name": "ä¹ç´«ç«æ˜Ÿ", "element": "ç«", "trait": "è¯ã‚„ã‹ã€çŸ¥æ€§"}
}
```

### 3.6 å§“ååˆ¤æ–­ (Name Analysis)

#### 3.6.1 è¨ˆç®—é …ç›®
1. **å¤©æ ¼**: å§“ã®ç·ç”»æ•°
2. **äººæ ¼**: å§“ã®æœ€å¾Œ + åã®æœ€åˆ
3. **åœ°æ ¼**: åã®ç·ç”»æ•°
4. **å¤–æ ¼**: ç·ç”» - äººæ ¼
5. **ç·æ ¼**: å§“åã®ç·ç”»æ•°

#### 3.6.2 è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯
```python
# æ¼¢å­—ç”»æ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆJISç¬¬1æ°´æº– 6,355å­—ï¼‰
stroke_db = {
    "ç”°": 5, "ä¸­": 4, "å¤ª": 4, "éƒ": 9,
    "ä½": 7, "è—¤": 18, "èŠ±": 7, "å­": 3,
    # ... å…¨æ¼¢å­—
}

def calculate_kaku(surname, given_name):
    surname_strokes = [stroke_db[char] for char in surname]
    given_strokes = [stroke_db[char] for char in given_name]

    tenkaku = sum(surname_strokes)
    chikaku = sum(given_strokes)
    jinkaku = surname_strokes[-1] + given_strokes[0]
    soukaku = tenkaku + chikaku
    gaikaku = soukaku - jinkaku

    return {
        "tenkaku": tenkaku,
        "jinkaku": jinkaku,
        "chikaku": chikaku,
        "gaikaku": gaikaku,
        "soukaku": soukaku
    }

# ç”»æ•°ã®å‰å‡¶åˆ¤å®šï¼ˆ81æ•°ç†ï¼‰
def evaluate_stroke(num):
    fortune_81 = {
        1: "å¤§å‰", 2: "å‡¶", 3: "å¤§å‰", 5: "å¤§å‰", 6: "å¤§å‰",
        7: "å‰", 8: "å‰", 11: "å¤§å‰", 13: "å¤§å‰", 15: "å¤§å‰",
        # ... 81ã¾ã§
    }
    return fortune_81.get(num % 81, "ä¸­å‰")
```

---

## 4. éœŠè¦–ã‚·ã‚¹ãƒ†ãƒ ä»•æ§˜

### 4.1 æ¦‚è¦
çµ±è¨ˆçš„ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ã¨æ·±å±¤å­¦ç¿’ã‚’çµ„ã¿åˆã‚ã›ã€ã€Œç›´æ„Ÿçš„æ´å¯Ÿã€ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã™ã‚‹AIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€‚å è¡“çš„ãƒ‡ãƒ¼ã‚¿ã«ã¯ç¾ã‚Œãªã„æ½œåœ¨çš„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡ºã—ã€ã‚ˆã‚Šãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºã•ã‚ŒãŸåŠ©è¨€ã‚’ç”Ÿæˆã™ã‚‹ã€‚

### 4.2 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
Input Layer:
  - 6å¤§å è¡“ã®çµ±åˆçµæœï¼ˆãƒ™ã‚¯ãƒˆãƒ«åŒ–ï¼‰
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ï¼ˆå¹´é½¢ã€æ€§åˆ¥ã€è·æ¥­ã€ç›¸è«‡å†…å®¹ï¼‰
  - éå»ã®é‘‘å®šå±¥æ­´ï¼ˆé¡ä¼¼ã‚±ãƒ¼ã‚¹ã®embeddingï¼‰

       â†“

Transformer Encoder:
  - Multi-head Self-Attention (8 heads)
  - Feed-forward Network
  - Layer Normalization

       â†“

Pattern Matching Layer:
  - 100ä¸‡ä»¶ã®éå»é‘‘å®šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰é¡ä¼¼ãƒ‘ã‚¿ãƒ¼ãƒ³æŠ½å‡º
  - Cosine Similarity ã§ Top-K (K=50) ã‚’å–å¾—

       â†“

Intuition Generation (Claude API):
  - å è¡“çµæœ + é¡ä¼¼ã‚±ãƒ¼ã‚¹ + ãƒ¦ãƒ¼ã‚¶ãƒ¼æ–‡è„ˆã‚’çµ±åˆ
  - "ç›´æ„Ÿçš„æ´å¯Ÿ" ã‚¹ã‚¿ã‚¤ãƒ«ã®ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ
  - æ¸©åº¦è¨­å®š: 0.9ï¼ˆå‰µé€ æ€§é‡è¦–ï¼‰

       â†“

Output:
  - "è¦‹ãˆã¦ãã‚‹ã‚‚ã®" ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ500-800æ–‡å­—ï¼‰
  - æŠ½è±¡çš„ãƒ»è±¡å¾´çš„è¡¨ç¾ã‚’å«ã‚€åŠ©è¨€
```

### 4.3 å­¦ç¿’ãƒ‡ãƒ¼ã‚¿
- **è¨“ç·´ãƒ‡ãƒ¼ã‚¿**: éå»100ä¸‡ä»¶ã®é‘‘å®šè¨˜éŒ²ï¼ˆåŒ¿ååŒ–æ¸ˆã¿ï¼‰
- **ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**: ã€Œæº€è¶³åº¦5æ®µéšè©•ä¾¡ã€ã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ï¼ˆ4ä»¥ä¸Šã®ã¿ä½¿ç”¨ï¼‰
- **å†å­¦ç¿’**: æœˆæ¬¡ã§ãƒ•ã‚¡ã‚¤ãƒ³ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°

### 4.4 ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
```
ã‚ãªãŸã¯çµŒé¨“è±Šå¯ŒãªéœŠèƒ½è€…ã§ã™ã€‚ä»¥ä¸‹ã®å è¡“çµæœã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å…ƒã«ã€
ç›´æ„Ÿçš„ã«æ„Ÿã˜å–ã‚Œã‚‹ã€Œè¦‹ãˆãªã„ã‚‚ã®ã€ã€Œæ„Ÿã˜å–ã‚Œã‚‹ã‚‚ã®ã€ã‚’è¡¨ç¾ã—ã¦ãã ã•ã„ã€‚

ã€å è¡“çµæœã€‘
{divination_summary}

ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€‘
- å¹´é½¢: {age}
- æ€§åˆ¥: {gender}
- ç›¸è«‡å†…å®¹: {question}

ã€é¡ä¼¼ã‚±ãƒ¼ã‚¹ã‹ã‚‰ã®æ´å¯Ÿã€‘
{similar_cases_summary}

ã€å‡ºåŠ›å½¢å¼ã€‘
- 500-800æ–‡å­—
- "ç§ã«ã¯ã€œãŒè¦‹ãˆã¾ã™" "ã€œã¨ã„ã†æ„Ÿè¦šãŒã‚ã‚Šã¾ã™" ãªã©ã®è¡¨ç¾ã‚’ä½¿ç”¨
- å…·ä½“çš„ã™ããšã€è±¡å¾´çš„ãƒ»æŠ½è±¡çš„ãªè¡¨ç¾
- ãƒã‚¸ãƒ†ã‚£ãƒ–ãªæœªæ¥ã¸ã®ç¤ºå”†ã‚’å«ã‚€

ã€å‡ºåŠ›ã€‘
```

### 4.5 å€«ç†çš„é…æ…®
- **å…è²¬äº‹é …ã®æ˜ç¤º**: ã€ŒéœŠè¦–AIã¯çµ±è¨ˆçš„æ¨è«–ã§ã‚ã‚Šã€è¶…è‡ªç„¶çš„èƒ½åŠ›ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€
- **éåº¦ãªä¾å­˜é˜²æ­¢**: ãƒã‚¬ãƒ†ã‚£ãƒ–ã™ãã‚‹è¡¨ç¾ã®è‡ªå‹•ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
- **äººæ¨©é…æ…®**: å·®åˆ¥çš„ãƒ»åè¦‹çš„è¡¨ç¾ã®æ¤œå‡ºã¨å‰Šé™¤

---

## 5. å‡ºåŠ›ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³

### 5.1 6000æ–‡å­—æ§‹æˆ

#### 5.1.1 ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹æˆ
```
ã€ç·æ–‡å­—æ•°: 6000æ–‡å­— Â± 200æ–‡å­—ã€‘

1. ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨ï¼ˆ200æ–‡å­—ï¼‰
   - æŒ¨æ‹¶
   - é‘‘å®šã®æ¦‚è¦
   - ä½¿ç”¨ã—ãŸå è¡“ã®èª¬æ˜

2. ç·åˆé‹å‹¢ï¼ˆ800æ–‡å­—ï¼‰
   - 6å¤§å è¡“ã®çµ±åˆåˆ†æ
   - ç¾åœ¨ã®é‹æ°—ã®å…¨ä½“åƒ
   - ä¸»è¦ãªãƒ†ãƒ¼ãƒ

3. è©³ç´°åˆ†æï¼ˆ3000æ–‡å­—ï¼‰
   â”œâ”€ æ€§æ ¼ãƒ»æ‰èƒ½ï¼ˆ500æ–‡å­—ï¼‰
   â”œâ”€ æ‹æ„›ãƒ»äººé–“é–¢ä¿‚ï¼ˆ600æ–‡å­—ï¼‰
   â”œâ”€ ä»•äº‹ãƒ»ã‚­ãƒ£ãƒªã‚¢ï¼ˆ600æ–‡å­—ï¼‰
   â”œâ”€ é‡‘é‹ãƒ»è²¡é‹ï¼ˆ500æ–‡å­—ï¼‰
   â”œâ”€ å¥åº·é‹ï¼ˆ400æ–‡å­—ï¼‰
   â””â”€ éœŠè¦–ã«ã‚ˆã‚‹æ´å¯Ÿï¼ˆ400æ–‡å­—ï¼‰

4. æ™‚æœŸåˆ¥ã‚¢ãƒ‰ãƒã‚¤ã‚¹ï¼ˆ1200æ–‡å­—ï¼‰
   â”œâ”€ ä»Šæœˆã®é‹å‹¢ï¼ˆ400æ–‡å­—ï¼‰
   â”œâ”€ 3ãƒ¶æœˆã®å±•æœ›ï¼ˆ400æ–‡å­—ï¼‰
   â””â”€ 1å¹´ã®æµã‚Œï¼ˆ400æ–‡å­—ï¼‰

5. ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ï¼ˆ500æ–‡å­—ï¼‰
   - å…·ä½“çš„ãªè¡Œå‹•æŒ‡é‡
   - ãƒ©ãƒƒã‚­ãƒ¼ã‚«ãƒ©ãƒ¼ãƒ»ãƒŠãƒ³ãƒãƒ¼
   - å‰æ–¹ä½ãƒ»å‰æ—¥

6. ã‚¢ãƒƒãƒ—ã‚»ãƒ«èª˜å°ï¼ˆ300æ–‡å­—ï¼‰
   - 3æ®µéšã®è¿½åŠ ã‚µãƒ¼ãƒ“ã‚¹æ¡ˆå†…
   - CTA (Call to Action)
```

### 5.2 ç”Ÿæˆãƒ•ãƒ­ãƒ¼

```python
class OutputGenerator:
    def __init__(self, claude_api_key):
        self.client = anthropic.Anthropic(api_key=claude_api_key)

    def generate_reading(self, divination_results, user_profile):
        # ã‚¹ãƒ†ãƒƒãƒ—1: å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
        prompts = self._build_section_prompts(divination_results, user_profile)

        # ã‚¹ãƒ†ãƒƒãƒ—2: Claude APIã§å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”Ÿæˆ
        sections = {}
        for section_name, prompt in prompts.items():
            sections[section_name] = self._call_claude(
                prompt=prompt,
                max_tokens=self._get_section_length(section_name),
                temperature=0.7
            )

        # ã‚¹ãƒ†ãƒƒãƒ—3: ã‚»ã‚¯ã‚·ãƒ§ãƒ³çµ±åˆ
        full_reading = self._assemble_sections(sections)

        # ã‚¹ãƒ†ãƒƒãƒ—4: æ–‡å­—æ•°èª¿æ•´ï¼ˆ6000æ–‡å­—Â±200ï¼‰
        full_reading = self._adjust_length(full_reading, target=6000, tolerance=200)

        # ã‚¹ãƒ†ãƒƒãƒ—5: å“è³ªãƒã‚§ãƒƒã‚¯
        if not self._quality_check(full_reading):
            full_reading = self._regenerate_with_feedback(full_reading)

        return full_reading

    def _call_claude(self, prompt, max_tokens, temperature):
        response = self.client.messages.create(
            model="claude-sonnet-4.5-20250929",
            max_tokens=max_tokens,
            temperature=temperature,
            messages=[{"role": "user", "content": prompt}]
        )
        return response.content[0].text
```

### 5.3 æ–‡ä½“ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

#### 5.3.1 ãƒˆãƒ¼ãƒ³
- **å…±æ„Ÿçš„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®çŠ¶æ³ã«å¯„ã‚Šæ·»ã†
- **åŠ±ã¾ã—**: ãƒã‚¸ãƒ†ã‚£ãƒ–ãªæœªæ¥ã‚’ç¤ºå”†
- **å°‚é–€çš„**: å è¡“ç”¨èªã‚’é©åˆ‡ã«ä½¿ç”¨
- **è¦ªã—ã¿ã‚„ã™ã•**: å …è‹¦ã—ããªã„ã€èª­ã¿ã‚„ã™ã„æ–‡ç« 

#### 5.3.2 ç¦æ­¢è¡¨ç¾
- æ–­å®šçš„ã™ãã‚‹è¡¨ç¾ï¼ˆã€Œå¿…ãšã€œã—ã¾ã™ã€ï¼‰
- ä¸å®‰ã‚’ç…½ã‚‹è¡¨ç¾ï¼ˆã€Œã“ã®ã¾ã¾ã§ã¯ã€œã€ï¼‰
- åŒ»ç™‚ãƒ»æ³•å¾‹ã‚¢ãƒ‰ãƒã‚¤ã‚¹
- æŠ•è³‡ãƒ»ã‚®ãƒ£ãƒ³ãƒ–ãƒ«ã®æ¨å¥¨

#### 5.3.3 æ¨å¥¨è¡¨ç¾
- ã€Œã€œã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€ã€Œã€œã®å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€
- ã€Œæ˜Ÿã€…ã¯ã€œã¨ç¤ºã—ã¦ã„ã¾ã™ã€
- ã€Œã‚ãªãŸã®æŒã¤ã€œã¨ã„ã†æ‰èƒ½ã€
- ã€Œã€œã‚’æ„è­˜ã™ã‚‹ã“ã¨ã§ã€é‹æ°—ãŒé–‹ã‘ã‚‹ã§ã—ã‚‡ã†ã€

---

## 6. ã‚¢ãƒƒãƒ—ã‚»ãƒ«èª˜å°æ©Ÿæ§‹

### 6.1 3æ®µéšã‚¢ãƒƒãƒ—ã‚»ãƒ«ãƒ¢ãƒ‡ãƒ«

```
ç„¡æ–™é‘‘å®šï¼ˆFree Tierï¼‰
  â†“
Type 1: å³æ™‚è©³ç´°é‘‘å®šï¼ˆÂ¥2,980ï¼‰
  â†“
Type 2: æœˆé¡ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆÂ¥980/æœˆï¼‰
  â†“
Type 3: å€‹åˆ¥ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ç›¸è«‡ï¼ˆÂ¥9,800/60åˆ†ï¼‰
```

### 6.2 Type 1: å³æ™‚è©³ç´°é‘‘å®š

#### 6.2.1 è¨´æ±‚ãƒã‚¤ãƒ³ãƒˆ
- **ä»Šã™ãçŸ¥ã‚ŠãŸã„å…·ä½“çš„ãªè³ªå•ã«å›ç­”**
- **ã‚±ãƒ«ãƒˆåå­—ã‚¿ãƒ­ãƒƒãƒˆ**ã«ã‚ˆã‚‹æ·±æ˜ã‚Šåˆ†æ
- **éå»3å¹´ãƒ»æœªæ¥3å¹´ã®è©³ç´°é‹å‹¢ã‚°ãƒ©ãƒ•**
- **ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã®ç›¸æ€§è¨ºæ–­**ï¼ˆç”Ÿå¹´æœˆæ—¥å…¥åŠ›ã§è¿½åŠ åˆ†æï¼‰

#### 6.2.2 èª˜å°ã‚¿ã‚¤ãƒŸãƒ³ã‚°
1. ç„¡æ–™é‘‘å®šçµæœã®ã€Œè©³ç´°åˆ†æã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³æœ«å°¾
2. ã€ŒéœŠè¦–ã«ã‚ˆã‚‹æ´å¯Ÿã€ã®ç›´å¾Œï¼ˆèˆˆå‘³ãŒé«˜ã¾ã‚‹ãƒã‚¤ãƒ³ãƒˆï¼‰
3. ã€Œã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ã€ã®å‰ï¼ˆè¡Œå‹•æ„æ¬²ãŒé«˜ã¾ã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼‰

#### 6.2.3 CTAï¼ˆCall to Actionï¼‰
```markdown
**â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”**
**âœ¨ ã•ã‚‰ã«è©³ã—ãçŸ¥ã‚ŠãŸã„ã‚ãªãŸã¸ âœ¨**

ã“ã®é‘‘å®šçµæœã‚’ã‚‚ã£ã¨æ·±ãæ˜ã‚Šä¸‹ã’ãŸ
**ã€è©³ç´°é‘‘å®šãƒ¬ãƒãƒ¼ãƒˆã€‘**ã‚’ã”ç”¨æ„ã§ãã¾ã™ã€‚

ã€å«ã¾ã‚Œã‚‹å†…å®¹ã€‘
âœ“ ã‚±ãƒ«ãƒˆåå­—ã‚¿ãƒ­ãƒƒãƒˆã«ã‚ˆã‚‹10æšå±•é–‹
âœ“ éå»3å¹´ãƒ»æœªæ¥3å¹´ã®é‹å‹¢ã‚°ãƒ©ãƒ•
âœ“ ç›¸æ€§è¨ºæ–­ï¼ˆãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼æƒ…å ±å…¥åŠ›ã§ï¼‰
âœ“ å…·ä½“çš„ãªè³ªå•ã¸ã®å€‹åˆ¥å›ç­”

**ä»Šã ã‘ç‰¹åˆ¥ä¾¡æ ¼: Â¥2,980**
ï¼ˆé€šå¸¸ä¾¡æ ¼ Â¥4,980ï¼‰

[è©³ç´°é‘‘å®šã‚’ç”³ã—è¾¼ã‚€ â†’]
**â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”**
```

### 6.3 Type 2: æœˆé¡ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³

#### 6.3.1 ã‚µãƒ¼ãƒ“ã‚¹å†…å®¹
- **æ¯æ—¥ã®é‹å‹¢æ›´æ–°**ï¼ˆãƒ‡ã‚¤ãƒªãƒ¼ãƒ›ãƒ­ã‚¹ã‚³ãƒ¼ãƒ—ï¼‰
- **é€±é–“ãƒ»æœˆé–“é‹å‹¢ãƒ¬ãƒãƒ¼ãƒˆ**
- **å‰æ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼**ï¼ˆå¥‘ç´„ãƒ»æ—…è¡Œãƒ»å‘Šç™½ãªã©ã®æ¨å¥¨æ—¥ï¼‰
- **Q&Aå„ªå…ˆå›ç­”**ï¼ˆæœˆ3å›ã¾ã§ï¼‰
- **é™å®šã‚³ãƒ©ãƒ **ï¼ˆå è¡“ã®æ·±ã„çŸ¥è­˜ï¼‰

#### 6.3.2 èª˜å°ã‚¿ã‚¤ãƒŸãƒ³ã‚°
1. 2å›ç›®ä»¥é™ã®ç„¡æ–™é‘‘å®šåˆ©ç”¨æ™‚
2. è©³ç´°é‘‘å®šè³¼å…¥å¾Œï¼ˆã‚¢ãƒƒãƒ—ã‚»ãƒ«ï¼‰
3. ãƒ¡ãƒ¼ãƒ«/ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ï¼ˆåˆå›é‘‘å®šã‹ã‚‰3æ—¥å¾Œï¼‰

#### 6.3.3 CTA
```markdown
**â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”**
**ğŸŒ™ ç¶™ç¶šçš„ãªã‚µãƒãƒ¼ãƒˆãŒå¿…è¦ãªæ–¹ã¸ ğŸŒ™**

é‹å‘½ã¯æ—¥ã€…å¤‰åŒ–ã—ã¾ã™ã€‚
**Nozomiãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡**ã«ãªã£ã¦ã€
æ¯æ—¥ã®é‹æ°—ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã›ã‚“ã‹ï¼Ÿ

ã€ä¼šå“¡ç‰¹å…¸ã€‘
âœ“ æ¯æ—¥ã®ãƒ‡ã‚¤ãƒªãƒ¼é‹å‹¢ï¼ˆæœ7æ™‚é…ä¿¡ï¼‰
âœ“ é€±é–“ãƒ»æœˆé–“ã®è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆ
âœ“ ã‚ãªãŸå°‚ç”¨ã®å‰æ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
âœ“ å ã„å¸«ã¸ã®è³ªå•ï¼ˆæœˆ3å›ï¼‰
âœ“ é™å®šã‚³ãƒ©ãƒ èª­ã¿æ”¾é¡Œ

**æœˆé¡ã‚ãšã‹ Â¥980**
ï¼ˆåˆæœˆç„¡æ–™ãƒ»ã„ã¤ã§ã‚‚è§£ç´„å¯èƒ½ï¼‰

[ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ã«ãªã‚‹ â†’]
**â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”**
```

### 6.4 Type 3: å€‹åˆ¥ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ç›¸è«‡

#### 6.4.1 ã‚µãƒ¼ãƒ“ã‚¹å†…å®¹
- **Zoom/Google Meetã§ã®ãƒãƒ³ãƒ„ãƒ¼ãƒãƒ³é‘‘å®š**ï¼ˆ60åˆ†ï¼‰
- **ãƒ—ãƒ­å ã„å¸«**ã¨ã®å¯¾è©±ã‚»ãƒƒã‚·ãƒ§ãƒ³
- **éŒ²ç”»ãƒ‡ãƒ¼ã‚¿æä¾›**ï¼ˆå¾©ç¿’ç”¨ï¼‰
- **ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒ¡ãƒ¼ãƒ«**ï¼ˆ3æ—¥å¾Œãƒ»1é€±é–“å¾Œï¼‰

#### 6.4.2 ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ
- æ·±åˆ»ãªæ‚©ã¿ï¼ˆé›¢å©šã€è»¢è·ã€èµ·æ¥­ãªã©ï¼‰
- é«˜é¡å•†å“è³¼å…¥è€…ï¼ˆãƒªãƒ”ãƒ¼ã‚¿ãƒ¼ï¼‰
- ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ï¼ˆ3ãƒ¶æœˆä»¥ä¸Šç¶™ç¶šï¼‰

#### 6.4.3 èª˜å°ã‚¿ã‚¤ãƒŸãƒ³ã‚°
1. è©³ç´°é‘‘å®šãƒ¬ãƒãƒ¼ãƒˆæœ«å°¾
2. ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡å‘ã‘é™å®šã‚ªãƒ•ã‚¡ãƒ¼
3. ç‰¹å®šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡ºæ™‚ï¼ˆã€Œé›¢å©šã€ã€Œèµ·æ¥­ã€ãªã©æ·±åˆ»ãªç›¸è«‡ï¼‰

#### 6.4.4 CTA
```markdown
**â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”**
**ğŸ‘¤ ãƒ—ãƒ­å ã„å¸«ã«ç›´æ¥ç›¸è«‡ã§ãã¾ã™ ğŸ‘¤**

æ–‡å­—ã ã‘ã§ã¯ä¼ãˆãã‚Œãªã„è¤‡é›‘ãªæ‚©ã¿ã€
ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ

**Nozomièªå®šãƒ—ãƒ­é‘‘å®šå£«**ã¨ã®
**ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å€‹åˆ¥ç›¸è«‡**ã§ã€
ã‚ãªãŸã ã‘ã®ç­”ãˆã‚’è¦‹ã¤ã‘ã¾ã—ã‚‡ã†ã€‚

ã€ã‚µãƒ¼ãƒ“ã‚¹å†…å®¹ã€‘
âœ“ 60åˆ†ã®ãƒãƒ³ãƒ„ãƒ¼ãƒãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³
âœ“ Zoom/Google Meetã§å¯¾é¢é‘‘å®š
âœ“ ã‚»ãƒƒã‚·ãƒ§ãƒ³éŒ²ç”»ãƒ‡ãƒ¼ã‚¿æä¾›
âœ“ ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒ¡ãƒ¼ãƒ«ï¼ˆ2å›ï¼‰

**æ–™é‡‘: Â¥9,800/60åˆ†**
ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ã¯ Â¥7,800ï¼‰

[å€‹åˆ¥ç›¸è«‡ã‚’äºˆç´„ã™ã‚‹ â†’]
**â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”**
```

### 6.5 ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³æœ€é©åŒ–

#### 6.5.1 A/Bãƒ†ã‚¹ãƒˆé …ç›®
- CTAãƒœã‚¿ãƒ³ã®è‰²ãƒ»æ–‡è¨€
- ä¾¡æ ¼è¡¨ç¤ºæ–¹æ³•ï¼ˆÂ¥2,980 vs "ã‚³ãƒ¼ãƒ’ãƒ¼10æ¯åˆ†"ï¼‰
- ç·Šæ€¥æ€§ã®æ¼”å‡ºï¼ˆã€Œä»Šã ã‘ã€vs ãªã—ï¼‰
- ç¤¾ä¼šçš„è¨¼æ˜ï¼ˆã€Œ10ä¸‡äººãŒåˆ©ç”¨ã€vs ãªã—ï¼‰

#### 6.5.2 KPI
| æŒ‡æ¨™ | ç›®æ¨™å€¤ |
|------|--------|
| ç„¡æ–™â†’Type 1 è»¢æ›ç‡ | 8% |
| Type 1â†’Type 2 è»¢æ›ç‡ | 15% |
| Type 2 ç¶™ç¶šç‡ï¼ˆ3ãƒ¶æœˆï¼‰ | 60% |
| Type 3 äºˆç´„ç‡ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ï¼‰ | 5% |

---

## 7. æŠ€è¡“ä»•æ§˜

### 7.1 APIè¨­è¨ˆ

#### 7.1.1 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

```
POST /api/v1/reading
  - æ–°è¦é‘‘å®šãƒªã‚¯ã‚¨ã‚¹ãƒˆ
  - Input: user_profile, birth_data, question
  - Output: reading_id, preview (ç„¡æ–™éƒ¨åˆ†)

GET /api/v1/reading/{reading_id}
  - é‘‘å®šçµæœå–å¾—
  - Auth: Bearer token (æœ‰æ–™ã®å ´åˆ)

POST /api/v1/reading/{reading_id}/upgrade
  - è©³ç´°é‘‘å®šã¸ã®ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰
  - Payment: Stripe token

POST /api/v1/subscription/create
  - ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ç™»éŒ²

GET /api/v1/daily-fortune
  - ãƒ‡ã‚¤ãƒªãƒ¼é‹å‹¢ï¼ˆä¼šå“¡å°‚ç”¨ï¼‰

POST /api/v1/consultation/book
  - å€‹åˆ¥ç›¸è«‡äºˆç´„
```

#### 7.1.2 ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¾‹

```json
POST /api/v1/reading

{
  "user_profile": {
    "user_id": "usr_12345",
    "name": "ç”°ä¸­ èŠ±å­",
    "birth_date": "1990-03-25",
    "birth_time": "14:30",
    "birth_place": {
      "latitude": 35.6762,
      "longitude": 139.6503,
      "timezone": "Asia/Tokyo"
    },
    "gender": "female",
    "age": 35
  },
  "question": "ä»Šå¹´ã®ä»•äº‹é‹ã¨ã€è»¢è·ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã„ã§ã™",
  "divination_types": ["astrology", "four_pillars", "tarot", "numerology", "nine_star", "name_analysis"],
  "options": {
    "include_spiritual_vision": true,
    "detail_level": "standard"
  }
}
```

#### 7.1.3 ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä¾‹

```json
{
  "reading_id": "rdg_67890",
  "status": "completed",
  "created_at": "2026-01-03T12:00:00Z",
  "divination_results": {
    "astrology": { /* ... */ },
    "four_pillars": { /* ... */ },
    "tarot": { /* ... */ },
    "numerology": { /* ... */ },
    "nine_star": { /* ... */ },
    "name_analysis": { /* ... */ },
    "spiritual_vision": { /* ... */ }
  },
  "generated_text": {
    "preview": "ï¼ˆç„¡æ–™éƒ¨åˆ†: æœ€åˆã®1500æ–‡å­—ï¼‰",
    "full_text": null,  // æœ‰æ–™è³¼å…¥å¾Œã«å–å¾—å¯èƒ½
    "word_count": 6100,
    "sections": {
      "header": "...",
      "overall_fortune": "...",
      "personality": "...",
      // ...
    }
  },
  "upsell_offers": [
    {
      "type": "detailed_reading",
      "price": 2980,
      "currency": "JPY",
      "description": "ã‚±ãƒ«ãƒˆåå­—ã‚¿ãƒ­ãƒƒãƒˆ + 3å¹´é‹å‹¢ã‚°ãƒ©ãƒ•",
      "cta_url": "/upgrade/rdg_67890"
    },
    {
      "type": "premium_subscription",
      "price": 980,
      "currency": "JPY",
      "billing_cycle": "monthly",
      "description": "æ¯æ—¥ã®é‹å‹¢ + å‰æ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼",
      "cta_url": "/subscription/create"
    }
  ],
  "metadata": {
    "processing_time_ms": 4200,
    "model_version": "nozomi-v1.2.0",
    "claude_model": "claude-sonnet-4.5-20250929"
  }
}
```

### 7.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

#### 7.2.1 PostgreSQLï¼ˆãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒŠãƒ«ãƒ‡ãƒ¼ã‚¿ï¼‰

```sql
-- Users table
CREATE TABLE users (
    user_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    name VARCHAR(100),
    birth_date DATE,
    birth_time TIME,
    birth_latitude DECIMAL(10, 8),
    birth_longitude DECIMAL(11, 8),
    gender VARCHAR(20),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    subscription_tier VARCHAR(50) DEFAULT 'free',
    subscription_expires_at TIMESTAMP
);

-- Readings table
CREATE TABLE readings (
    reading_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(user_id),
    question TEXT,
    status VARCHAR(50),
    tier VARCHAR(50) DEFAULT 'free',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    processing_time_ms INTEGER,
    word_count INTEGER
);

-- Payments table
CREATE TABLE payments (
    payment_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(user_id),
    reading_id UUID REFERENCES readings(reading_id),
    amount INTEGER,
    currency VARCHAR(3),
    payment_method VARCHAR(50),
    status VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Consultations table
CREATE TABLE consultations (
    consultation_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(user_id),
    consultant_name VARCHAR(100),
    scheduled_at TIMESTAMP,
    duration_minutes INTEGER,
    zoom_link TEXT,
    status VARCHAR(50),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 7.2.2 MongoDBï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ï¼‰

```javascript
// readings ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³
{
  "_id": ObjectId("..."),
  "reading_id": "rdg_67890",
  "user_id": "usr_12345",
  "divination_results": {
    "astrology": { /* è©³ç´°ãªå¤©ä½“è¨ˆç®—çµæœ */ },
    "four_pillars": { /* å››æŸ±æ¨å‘½ãƒ‡ãƒ¼ã‚¿ */ },
    // ... ä»–ã®å è¡“
  },
  "generated_text": {
    "sections": {
      "header": "...",
      "overall_fortune": "...",
      // ... å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³
    },
    "full_text": "ï¼ˆ6000æ–‡å­—ã®å®Œå…¨ç‰ˆï¼‰",
    "prompts_used": [ /* ç”Ÿæˆã«ä½¿ç”¨ã—ãŸãƒ—ãƒ­ãƒ³ãƒ—ãƒˆå±¥æ­´ */ ]
  },
  "metadata": {
    "model_version": "nozomi-v1.2.0",
    "processing_time_ms": 4200
  },
  "created_at": ISODate("2026-01-03T12:00:00Z")
}

// user_feedback ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆå“è³ªæ”¹å–„ç”¨ï¼‰
{
  "_id": ObjectId("..."),
  "reading_id": "rdg_67890",
  "user_id": "usr_12345",
  "rating": 5,
  "feedback_text": "ã¨ã¦ã‚‚å½“ãŸã£ã¦ã„ã¾ã—ãŸï¼",
  "created_at": ISODate("2026-01-03T14:00:00Z")
}
```

### 7.3 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶

| é …ç›® | ç›®æ¨™å€¤ |
|------|--------|
| é‘‘å®šçµæœç”Ÿæˆæ™‚é–“ | < 5ç§’ï¼ˆP95ï¼‰ |
| APIå¿œç­”æ™‚é–“ | < 200msï¼ˆP95ï¼‰ |
| åŒæ™‚æ¥ç¶šãƒ¦ãƒ¼ã‚¶ãƒ¼ | 10,000 |
| 1æ—¥ã®é‘‘å®šå‡¦ç†æ•° | 100,000ä»¶ |

### 7.4 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

#### 7.4.1 ãƒ‡ãƒ¼ã‚¿ä¿è­·
- **å€‹äººæƒ…å ±æš—å·åŒ–**: AES-256ï¼ˆç”Ÿå¹´æœˆæ—¥ã€åå‰ï¼‰
- **é€šä¿¡**: TLS 1.3å¼·åˆ¶
- **èªè¨¼**: JWT + Refresh Token
- **æ±ºæ¸ˆ**: PCI DSSæº–æ‹ ï¼ˆStripeåˆ©ç”¨ï¼‰

#### 7.4.2 ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡
- **RBAC**: Admin / Consultant / Premium / Free
- **Rate Limiting**: ç„¡æ–™ãƒ¦ãƒ¼ã‚¶ãƒ¼ 10req/hourã€æœ‰æ–™ãƒ¦ãƒ¼ã‚¶ãƒ¼ 100req/hour

---

## 8. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 8.1 é‘‘å®šå‡¦ç†ãƒ•ãƒ­ãƒ¼

```mermaid
sequenceDiagram
    participant User
    participant API Gateway
    participant Auth Service
    participant Orchestrator
    participant Divination Engine
    participant Claude API
    participant Database
    participant Payment Service

    User->>API Gateway: POST /api/v1/reading
    API Gateway->>Auth Service: Verify JWT
    Auth Service-->>API Gateway: Token Valid

    API Gateway->>Orchestrator: Start Reading
    Orchestrator->>Divination Engine: Calculate 6 Divinations

    par Parallel Calculations
        Divination Engine->>Divination Engine: Astrology
        Divination Engine->>Divination Engine: Four Pillars
        Divination Engine->>Divination Engine: Tarot
        Divination Engine->>Divination Engine: Numerology
        Divination Engine->>Divination Engine: Nine Star
        Divination Engine->>Divination Engine: Name Analysis
    end

    Divination Engine-->>Orchestrator: Results
    Orchestrator->>Claude API: Generate Text (6000chars)
    Claude API-->>Orchestrator: Generated Text

    Orchestrator->>Database: Save Reading
    Database-->>Orchestrator: reading_id

    Orchestrator-->>API Gateway: Preview (1500chars) + Upsell
    API Gateway-->>User: Response with Preview

    alt User purchases detailed reading
        User->>Payment Service: Pay Â¥2,980
        Payment Service-->>Database: Payment Record
        Payment Service-->>API Gateway: Payment Success
        API Gateway->>Database: Get Full Reading
        Database-->>API Gateway: Full Text (6000chars)
        API Gateway-->>User: Complete Reading
    end
```

### 8.2 ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
   â†“
2. Stripe Checkout Sessionä½œæˆ
   â†“
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚«ãƒ¼ãƒ‰æƒ…å ±å…¥åŠ›
   â†“
4. Stripe Webhook: checkout.session.completed
   â†“
5. DBã«subscription_tieræ›´æ–°
   â†“
6. æ¯æ—¥7:00 AMã«ãƒ‡ã‚¤ãƒªãƒ¼é‹å‹¢ç”Ÿæˆï¼ˆCron Jobï¼‰
   â†“
7. ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥/ãƒ¡ãƒ¼ãƒ«é…ä¿¡
   â†“
8. æœˆæ¬¡ã§Stripeè‡ªå‹•èª²é‡‘
   â†“
9. Webhook: invoice.payment_succeeded â†’ ã‚µãƒ–ã‚¹ã‚¯ç¶™ç¶š
   ã¾ãŸã¯
   Webhook: invoice.payment_failed â†’ ç£ä¿ƒãƒ¡ãƒ¼ãƒ«
```

---

## 9. å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

### 9.1 é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚º

#### Phase 1: MVPï¼ˆ3ãƒ¶æœˆï¼‰
- [x] è¥¿æ´‹å æ˜Ÿè¡“ + å››æŸ±æ¨å‘½ã®å®Ÿè£…
- [x] åŸºæœ¬çš„ãªå‡ºåŠ›ç”Ÿæˆï¼ˆ3000æ–‡å­—ï¼‰
- [x] Type 1ã‚¢ãƒƒãƒ—ã‚»ãƒ«ï¼ˆè©³ç´°é‘‘å®šï¼‰ã®ã¿
- [x] æ±ºæ¸ˆé€£æºï¼ˆStripeï¼‰

#### Phase 2: æ©Ÿèƒ½æ‹¡å¼µï¼ˆ2ãƒ¶æœˆï¼‰
- [ ] ã‚¿ãƒ­ãƒƒãƒˆ + æ•°ç§˜è¡“ + ä¹æ˜Ÿæ°—å­¦ + å§“ååˆ¤æ–­ã®è¿½åŠ 
- [ ] 6000æ–‡å­—å‡ºåŠ›ã¸ã®æ‹¡å¼µ
- [ ] éœŠè¦–AIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®å®Ÿè£…
- [ ] Type 2ã‚¢ãƒƒãƒ—ã‚»ãƒ«ï¼ˆã‚µãƒ–ã‚¹ã‚¯ï¼‰

#### Phase 3: æœ€é©åŒ–ï¼ˆ1ãƒ¶æœˆï¼‰
- [ ] Type 3ã‚¢ãƒƒãƒ—ã‚»ãƒ«ï¼ˆå€‹åˆ¥ç›¸è«‡ï¼‰
- [ ] A/Bãƒ†ã‚¹ãƒˆåŸºç›¤
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- [ ] ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªï¼ˆReact Nativeï¼‰

### 9.2 ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„

#### 9.2.1 Pythonï¼ˆå è¡“ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
```python
# PEP 8æº–æ‹ 
# Type hintså¿…é ˆ

from typing import Dict, List, Optional
from datetime import datetime

def calculate_astrology(
    birth_date: datetime,
    birth_time: str,
    latitude: float,
    longitude: float
) -> Dict[str, any]:
    """
    è¥¿æ´‹å æ˜Ÿè¡“ã®è¨ˆç®—ã‚’å®Ÿè¡Œ

    Args:
        birth_date: ç”Ÿå¹´æœˆæ—¥
        birth_time: å‡ºç”Ÿæ™‚åˆ» (HH:MMå½¢å¼)
        latitude: ç·¯åº¦
        longitude: çµŒåº¦

    Returns:
        å æ˜Ÿè¡“çµæœã®è¾æ›¸
    """
    # å®Ÿè£…
    pass
```

#### 9.2.2 TypeScriptï¼ˆAPIå±¤ï¼‰
```typescript
// Strict modeæœ‰åŠ¹
// ESLint + Prettier

interface ReadingRequest {
  userProfile: UserProfile;
  question: string;
  divinationTypes: DivinationType[];
  options?: ReadingOptions;
}

interface DivinationResult {
  astrology?: AstrologyResult;
  fourPillars?: FourPillarsResult;
  // ...
}

async function createReading(
  request: ReadingRequest
): Promise<ReadingResponse> {
  // å®Ÿè£…
}
```

### 9.3 ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

#### 9.3.1 ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
- **ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™**: 80%ä»¥ä¸Š
- **é‡ç‚¹ãƒ†ã‚¹ãƒˆ**: å è¡“è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ã€æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ

```python
def test_calculate_life_path_number():
    assert calculate_life_path("1990-03-25") == 11
    assert calculate_life_path("1985-12-01") == 9
```

#### 9.3.2 çµ±åˆãƒ†ã‚¹ãƒˆ
- **ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰**: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ› â†’ é‘‘å®šçµæœç”Ÿæˆ â†’ å‡ºåŠ›æ¤œè¨¼
- **Claude API Mock**: é–‹ç™ºç’°å¢ƒã§ã¯ãƒ¢ãƒƒã‚¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ä½¿ç”¨ï¼ˆã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼‰

#### 9.3.3 å“è³ªãƒ†ã‚¹ãƒˆ
- **æ–‡å­—æ•°æ¤œè¨¼**: 6000æ–‡å­— Â± 200æ–‡å­—ã®ç¯„å›²å†…
- **ç¦æ­¢è¡¨ç¾ãƒã‚§ãƒƒã‚¯**: NGãƒ¯ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆã¨ã®ãƒãƒƒãƒãƒ³ã‚°
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼æº€è¶³åº¦**: Î²ç‰ˆã§100äººã«ãƒ†ã‚¹ãƒˆã€å¹³å‡4.0ä»¥ä¸Š

### 9.4 ãƒ‡ãƒ—ãƒ­ã‚¤æˆ¦ç•¥

#### 9.4.1 ç’°å¢ƒ
- **é–‹ç™º**: Docker Composeï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
- **ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°**: GCP Cloud Runï¼ˆè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ï¼‰
- **æœ¬ç•ª**: Kubernetes (GKE) + Cloud SQL

#### 9.4.2 CI/CD
```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run tests
        run: |
          npm run test
          python -m pytest

  deploy:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to GKE
        run: |
          gcloud container clusters get-credentials nozomi-cluster
          kubectl apply -f k8s/
```

### 9.5 ç›£è¦–ãƒ»é‹ç”¨

#### 9.5.1 ãƒ¡ãƒˆãƒªã‚¯ã‚¹
- **Prometheus + Grafana**: APIå¿œç­”æ™‚é–“ã€ã‚¨ãƒ©ãƒ¼ç‡ã€åŒæ™‚æ¥ç¶šæ•°
- **Sentry**: ã‚¨ãƒ©ãƒ¼ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°
- **Google Analytics**: ãƒ¦ãƒ¼ã‚¶ãƒ¼è¡Œå‹•åˆ†æ

#### 9.5.2 ã‚¢ãƒ©ãƒ¼ãƒˆ
- ã‚¨ãƒ©ãƒ¼ç‡ > 1%
- APIå¿œç­”æ™‚é–“ P95 > 5ç§’
- Claude APIæ®‹é«˜ < $100

---

## 10. ä»˜éŒ²

### 10.1 ç”¨èªé›†

| ç”¨èª | èª¬æ˜ |
|------|------|
| ãƒ›ãƒ­ã‚¹ã‚³ãƒ¼ãƒ— | å¤©ä½“ã®é…ç½®å›³ |
| ã‚¢ã‚¹ãƒšã‚¯ãƒˆ | å¤©ä½“é–“ã®è§’åº¦é–¢ä¿‚ |
| å››æŸ± | å¹´ãƒ»æœˆãƒ»æ—¥ãƒ»æ™‚ã®4ã¤ã®æŸ± |
| é€šå¤‰æ˜Ÿ | å››æŸ±æ¨å‘½ã®æ€§æ ¼åˆ†é¡ |
| ãƒã‚¹ã‚¿ãƒ¼ãƒŠãƒ³ãƒãƒ¼ | æ•°ç§˜è¡“ã®ç‰¹åˆ¥ãªæ•°å­—ï¼ˆ11, 22, 33ï¼‰ |
| æœ¬å‘½æ˜Ÿ | ä¹æ˜Ÿæ°—å­¦ã®ç”Ÿã¾ã‚Œå¹´ã®æ˜Ÿ |

### 10.2 å‚è€ƒæ–‡çŒ®

1. "The Only Astrology Book You'll Ever Need" - Joanna Martine Woolfolk
2. "å››æŸ±æ¨å‘½å®Œå…¨ãƒã‚¹ã‚¿ãƒ¼" - é»„å°å¨¥
3. "The Tarot Bible" - Sarah Bartlett
4. "Numerology: The Complete Guide" - Matthew Oliver Goodwin

### 10.3 å¤–éƒ¨API

| API | ç”¨é€” | æ–™é‡‘ |
|-----|------|------|
| Anthropic Claude API | ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ | $0.015/1K tokens (input), $0.075/1K tokens (output) |
| Swiss Ephemeris | å¤©ä½“è¨ˆç®— | ç„¡æ–™ï¼ˆã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ï¼‰ |
| Stripe | æ±ºæ¸ˆ | 3.6% |
| SendGrid | ãƒ¡ãƒ¼ãƒ«é…ä¿¡ | $19.95/æœˆï¼ˆ50,000é€šã¾ã§ï¼‰ |

---

**æ–‡æ›¸ç®¡ç†**
- **ä½œæˆè€…**: Autonomous Development Team
- **æ‰¿èªè€…**: Product Owner
- **æœ€çµ‚æ›´æ–°**: 2026-01-03
- **ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
- **æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼**: 2026-04-01

---

ğŸŒ¸ **Nozomi - å¸Œæœ›ã‚’ç…§ã‚‰ã™AIé‘‘å®šã‚·ã‚¹ãƒ†ãƒ ** ğŸŒ¸
