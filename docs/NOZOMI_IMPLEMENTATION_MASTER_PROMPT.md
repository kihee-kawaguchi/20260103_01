# Nozomi å®Ÿè£…ç”¨ãƒã‚¹ã‚¿ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ

**Version:** 1.0.0
**å¯¾è±¡:** AIé–‹ç™ºã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ / é–‹ç™ºè€…
**ç›®çš„:** çµ±åˆå‹AIé‘‘å®šã‚·ã‚¹ãƒ†ãƒ ã€ŒNozomiã€ã®å®Œå…¨å®Ÿè£…

---

## ã“ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ä½¿ã„æ–¹

ã“ã®ãƒã‚¹ã‚¿ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯ã€AIé–‹ç™ºã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆï¼ˆClaudeã€GPT-4ç­‰ï¼‰ã«æ¸¡ã™ã“ã¨ã§ã€Nozomiã‚·ã‚¹ãƒ†ãƒ ã®å„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ®µéšçš„ã«å®Ÿè£…ã§ãã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

### æ¨å¥¨ã•ã‚Œã‚‹ä½¿ç”¨æ–¹æ³•

1. **ãƒ•ã‚§ãƒ¼ã‚ºåˆ†å‰²**: ã“ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’6ã¤ã®ãƒ•ã‚§ãƒ¼ã‚ºã«åˆ†ã‘ã¦å®Ÿè£…
2. **æ¤œè¨¼**: å„ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†å¾Œã€ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã¨çµ±åˆãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
3. **åå¾©æ”¹å–„**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å…ƒã«ç¶™ç¶šçš„ã«æ”¹å–„

---

## ãƒã‚¹ã‚¿ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæœ¬æ–‡

```
# çµ±åˆå‹AIé‘‘å®šã‚·ã‚¹ãƒ†ãƒ ã€ŒNozomiã€å®Ÿè£…æŒ‡ç¤ºæ›¸

ã‚ãªãŸã¯çµŒé¨“è±Šå¯Œãªãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯é–‹ç™ºè€…ã§ã™ã€‚ä»¥ä¸‹ã®ä»•æ§˜ã«åŸºã¥ãã€çµ±åˆå‹AIé‘‘å®šã‚·ã‚¹ãƒ†ãƒ ã€ŒNozomiã€ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**ã‚·ã‚¹ãƒ†ãƒ å**: Nozomiï¼ˆã®ãã¿ / å¸Œï¼‰
**ç›®çš„**: 6å¤§å è¡“ï¼ˆè¥¿æ´‹å æ˜Ÿè¡“ã€å››æŸ±æ¨å‘½ã€ã‚¿ãƒ­ãƒƒãƒˆã€æ•°ç§˜è¡“ã€ä¹æ˜Ÿæ°—å­¦ã€å§“ååˆ¤æ–­ï¼‰ã¨éœŠè¦–AIã‚’çµ±åˆã—ã€6000æ–‡å­—ã®è©³ç´°é‘‘å®šã‚’ç”Ÿæˆã€‚3æ®µéšã®ã‚¢ãƒƒãƒ—ã‚»ãƒ«æ©Ÿèƒ½ã«ã‚ˆã‚Šåç›ŠåŒ–ã€‚

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- Next.js 14.2+ (App Router)
- TypeScript 5.3+
- Tailwind CSS
- React Hook Form + Zodï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
- Framer Motionï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- Node.js 20+ / Express
- Python 3.11+ï¼ˆå è¡“è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³ï¼‰
- PostgreSQL 16ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»æ±ºæ¸ˆãƒ‡ãƒ¼ã‚¿ï¼‰
- MongoDB 7ï¼ˆé‘‘å®šçµæœãƒ»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼‰
- Redis 7ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ï¼‰

### AI / ML
- Anthropic Claude Sonnet 4.5 API
- Swiss Ephemerisï¼ˆå¤©ä½“è¨ˆç®—ï¼‰
- TensorFlow 2.15ï¼ˆéœŠè¦–AIãƒ¢ãƒ‡ãƒ« - ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

### ã‚¤ãƒ³ãƒ•ãƒ©
- Docker + Docker Compose
- Kubernetesï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰
- GCPï¼ˆCloud Run, Cloud SQL, GKEï¼‰
- Stripeï¼ˆæ±ºæ¸ˆï¼‰

---

## å®Ÿè£…ãƒ•ã‚§ãƒ¼ã‚º

### Phase 1: åŸºç›¤æ§‹ç¯‰ï¼ˆWeek 1-2ï¼‰

#### ã‚¿ã‚¹ã‚¯ 1.1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**æŒ‡ç¤º:**
ä»¥ä¸‹ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã§ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

\`\`\`
nozomi/
â”œâ”€â”€ frontend/                 # Next.js ã‚¢ãƒ—ãƒª
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/             # App Router
â”‚   â”‚   â”œâ”€â”€ components/      # Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ lib/             # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â””â”€â”€ types/           # TypeScriptå‹å®šç¾©
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ backend/                 # Express API
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ routes/          # APIãƒ«ãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ controllers/     # ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ services/        # å¤–éƒ¨APIé€£æº
â”‚   â”‚   â”œâ”€â”€ models/          # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â””â”€â”€ middleware/      # èªè¨¼ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”‚
â”œâ”€â”€ divination-engine/       # Pythonå è¡“ã‚¨ãƒ³ã‚¸ãƒ³
â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”œâ”€â”€ astrology.py     # è¥¿æ´‹å æ˜Ÿè¡“
â”‚   â”‚   â”œâ”€â”€ four_pillars.py  # å››æŸ±æ¨å‘½
â”‚   â”‚   â”œâ”€â”€ tarot.py         # ã‚¿ãƒ­ãƒƒãƒˆ
â”‚   â”‚   â”œâ”€â”€ numerology.py    # æ•°ç§˜è¡“
â”‚   â”‚   â”œâ”€â”€ nine_star.py     # ä¹æ˜Ÿæ°—å­¦
â”‚   â”‚   â””â”€â”€ name_analysis.py # å§“ååˆ¤æ–­
â”‚   â”œâ”€â”€ orchestrator.py      # çµ±åˆåˆ¶å¾¡
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â””â”€â”€ tests/
â”‚
â”œâ”€â”€ spiritual-vision/        # éœŠè¦–AIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ model/               # æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ inference.py         # æ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³
â”‚   â””â”€â”€ requirements.txt
â”‚
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ Dockerfile.frontend
â”‚   â”œâ”€â”€ Dockerfile.backend
â”‚   â”œâ”€â”€ Dockerfile.python
â”‚   â””â”€â”€ docker-compose.yml
â”‚
â”œâ”€â”€ k8s/                     # Kubernetesè¨­å®š
â”‚   â”œâ”€â”€ deployment.yaml
â”‚   â”œâ”€â”€ service.yaml
â”‚   â””â”€â”€ ingress.yaml
â”‚
â””â”€â”€ docs/
    â”œâ”€â”€ API.md
    â””â”€â”€ DESIGN.md
\`\`\`

**å®Ÿè£…è¦ä»¶:**
1. package.json / requirements.txt ã‚’ä½œæˆ
2. TypeScript strict modeæœ‰åŠ¹åŒ–
3. ESLint + Prettierè¨­å®š
4. .env.example ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼ˆAPI key templateï¼‰

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:**
- ã™ã¹ã¦ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- \`npm install\` / \`pip install\` ãŒæˆåŠŸã™ã‚‹
- \`npm run dev\` ã§Next.jsãŒèµ·å‹•ã™ã‚‹

---

#### ã‚¿ã‚¹ã‚¯ 1.2: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒå®Ÿè£…

**æŒ‡ç¤º:**
PostgreSQLã¨MongoDBã®ã‚¹ã‚­ãƒ¼ãƒã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

**PostgreSQLï¼ˆbackend/src/models/schema.sqlï¼‰:**

\`\`\`sql
-- Users table
CREATE TABLE users (
    user_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255),  -- bcrypt
    name VARCHAR(100),
    birth_date DATE,
    birth_time TIME,
    birth_latitude DECIMAL(10, 8),
    birth_longitude DECIMAL(11, 8),
    birth_timezone VARCHAR(50) DEFAULT 'Asia/Tokyo',
    gender VARCHAR(20),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

    -- ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³
    subscription_tier VARCHAR(50) DEFAULT 'free',
    subscription_started_at TIMESTAMP,
    subscription_expires_at TIMESTAMP,
    stripe_customer_id VARCHAR(255),

    -- çµ±è¨ˆ
    total_readings INTEGER DEFAULT 0,
    last_reading_at TIMESTAMP
);

CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_subscription ON users(subscription_tier, subscription_expires_at);

-- Readings table
CREATE TABLE readings (
    reading_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(user_id) ON DELETE CASCADE,
    question TEXT,
    status VARCHAR(50) DEFAULT 'processing',  -- processing, completed, failed
    tier VARCHAR(50) DEFAULT 'free',          -- free, detailed, premium
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    completed_at TIMESTAMP,
    processing_time_ms INTEGER,
    word_count INTEGER,

    -- é‘‘å®šè¨­å®š
    divination_types TEXT[],  -- ['astrology', 'tarot', ...]
    include_spiritual_vision BOOLEAN DEFAULT true
);

CREATE INDEX idx_readings_user ON readings(user_id, created_at DESC);
CREATE INDEX idx_readings_status ON readings(status);

-- Payments table
CREATE TABLE payments (
    payment_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(user_id),
    reading_id UUID REFERENCES readings(reading_id),
    payment_type VARCHAR(50),  -- one_time, subscription
    amount INTEGER,            -- é‡‘é¡ï¼ˆå††ï¼‰
    currency VARCHAR(3) DEFAULT 'JPY',
    payment_method VARCHAR(50),
    stripe_payment_intent_id VARCHAR(255),
    status VARCHAR(50),        -- pending, succeeded, failed, refunded
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    paid_at TIMESTAMP
);

CREATE INDEX idx_payments_user ON payments(user_id, created_at DESC);
CREATE INDEX idx_payments_status ON payments(status);

-- Consultations tableï¼ˆå€‹åˆ¥ç›¸è«‡äºˆç´„ï¼‰
CREATE TABLE consultations (
    consultation_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID REFERENCES users(user_id),
    consultant_name VARCHAR(100),
    scheduled_at TIMESTAMP NOT NULL,
    duration_minutes INTEGER DEFAULT 60,
    zoom_link TEXT,
    status VARCHAR(50) DEFAULT 'scheduled',  -- scheduled, completed, cancelled
    notes TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_consultations_user ON consultations(user_id);
CREATE INDEX idx_consultations_schedule ON consultations(scheduled_at);
\`\`\`

**MongoDBï¼ˆã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆæ›¸ï¼‰:**

\`\`\`javascript
// Collection: readings_data
// é‘‘å®šçµæœã®è©³ç´°ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ï¼ˆPostgreSQLã«ã¯å…¥ã‚‰ãªã„å¤§å®¹é‡ãƒ‡ãƒ¼ã‚¿ï¼‰

{
  _id: ObjectId("..."),
  reading_id: "rdg_12345",  // PostgreSQLã¨ç´ä»˜ã‘
  user_id: "usr_67890",

  // å è¡“è¨ˆç®—çµæœ
  divination_results: {
    astrology: {
      sun_sign: "ç‰¡ç¾Šåº§",
      moon_sign: "èŸ¹åº§",
      ascendant: "ç…å­åº§",
      planets: [
        { name: "sun", sign: "ç‰¡ç¾Šåº§", house: 9, degree: 15.23 },
        { name: "moon", sign: "èŸ¹åº§", house: 12, degree: 8.45 }
        // ...
      ],
      aspects: [
        { planet1: "sun", planet2: "mars", aspect: "trine", orb: 2.3 }
      ],
      interpretation: {
        personality: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã«å„ªã‚Œ...",
        strength: "æ±ºæ–­åŠ›ã€è¡Œå‹•åŠ›",
        challenge: "è¡å‹•æ€§ã€çŸ­æ°—"
      }
    },
    four_pillars: { /* å››æŸ±æ¨å‘½ãƒ‡ãƒ¼ã‚¿ */ },
    tarot: { /* ã‚¿ãƒ­ãƒƒãƒˆçµæœ */ },
    numerology: { /* æ•°ç§˜è¡“ */ },
    nine_star: { /* ä¹æ˜Ÿæ°—å­¦ */ },
    name_analysis: { /* å§“ååˆ¤æ–­ */ }
  },

  // éœŠè¦–AIã®å‡ºåŠ›
  spiritual_vision: {
    insight_text: "ç§ã«ã¯ã‚ãªãŸã®å‘¨ã‚Šã«...",
    confidence_score: 0.87,
    key_symbols: ["å…‰", "æ‰‰", "æ–°ã—ã„é“"],
    model_version: "spiritual-v1.2.0"
  },

  // ç”Ÿæˆã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆ
  generated_text: {
    sections: {
      header: "ã‚ãªãŸã®é‹å‘½ã‚’ç´è§£ã...",
      overall_fortune: "ç¾åœ¨ã€ã‚ãªãŸã¯...",
      personality: "ã‚ãªãŸã¯ç”Ÿã¾ã‚ŒãªãŒã‚‰ã«...",
      love: "æ‹æ„›é¢ã§ã¯...",
      career: "ä»•äº‹é‹ã¯...",
      money: "é‡‘é‹ã«ã¤ã„ã¦...",
      health: "å¥åº·é¢ã§ã¯...",
      spiritual: "éœŠè¦–ã«ã‚ˆã‚‹æ´å¯Ÿ...",
      monthly_forecast: "ä»Šæœˆã®é‹å‹¢...",
      quarterly_forecast: "3ãƒ¶æœˆã®å±•æœ›...",
      yearly_forecast: "1å¹´ã®æµã‚Œ...",
      action_plan: "å…·ä½“çš„ã«ã¯...",
      upsell: "ã•ã‚‰ã«è©³ã—ãçŸ¥ã‚ŠãŸã„æ–¹ã¸..."
    },
    full_text: "ï¼ˆ6000æ–‡å­—ã®å®Œå…¨ç‰ˆãƒ†ã‚­ã‚¹ãƒˆï¼‰",
    word_count: 6024,
    prompts_used: [
      { section: "overall_fortune", prompt: "...", tokens_used: 450 }
    ]
  },

  // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
  metadata: {
    processing_time_ms: 4200,
    model_version: "nozomi-v1.2.0",
    claude_model: "claude-sonnet-4.5-20250929",
    total_tokens: 8500,
    estimated_cost_usd: 0.42
  },

  created_at: ISODate("2026-01-03T12:00:00Z"),
  updated_at: ISODate("2026-01-03T12:00:04Z")
}

// Collection: user_feedback
// ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆå“è³ªæ”¹å–„ç”¨ï¼‰

{
  _id: ObjectId("..."),
  reading_id: "rdg_12345",
  user_id: "usr_67890",
  rating: 5,  // 1-5
  feedback_text: "ã¨ã¦ã‚‚å½“ãŸã£ã¦ã„ã¦é©šãã¾ã—ãŸï¼",
  helpful_sections: ["spiritual", "career"],
  created_at: ISODate("2026-01-03T14:00:00Z")
}
\`\`\`

**å®Ÿè£…è¦ä»¶:**
1. PostgreSQLæ¥ç¶šï¼ˆpg / Prismaä½¿ç”¨æ¨å¥¨ï¼‰
2. MongoDBæ¥ç¶šï¼ˆmongooseä½¿ç”¨ï¼‰
3. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
4. ã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ†ã‚¹ãƒˆç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼5ä»¶ï¼‰

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:**
- ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ»ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ãŒä½œæˆã•ã‚Œã‚‹
- \`npm run migrate\` ã§ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ
- \`npm run seed\` ã§ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æŒ¿å…¥æˆåŠŸ

---

### Phase 2: å è¡“ã‚¨ãƒ³ã‚¸ãƒ³å®Ÿè£…ï¼ˆWeek 3-5ï¼‰

#### ã‚¿ã‚¹ã‚¯ 2.1: è¥¿æ´‹å æ˜Ÿè¡“ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

**æŒ‡ç¤º:**
Swiss Ephemerisã‚’ä½¿ç”¨ã—ã¦è¥¿æ´‹å æ˜Ÿè¡“ã®è¨ˆç®—ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«:** \`divination-engine/modules/astrology.py\`

\`\`\`python
from datetime import datetime
import swisseph as swe
from typing import Dict, List, Tuple
import pytz

class AstrologyCalculator:
    """è¥¿æ´‹å æ˜Ÿè¡“è¨ˆç®—ã‚¨ãƒ³ã‚¸ãƒ³"""

    # å¤©ä½“å®šç¾©
    PLANETS = {
        'sun': swe.SUN,
        'moon': swe.MOON,
        'mercury': swe.MERCURY,
        'venus': swe.VENUS,
        'mars': swe.MARS,
        'jupiter': swe.JUPITER,
        'saturn': swe.SATURN,
        'uranus': swe.URANUS,
        'neptune': swe.NEPTUNE,
        'pluto': swe.PLUTO
    }

    # æ˜Ÿåº§å
    SIGNS = [
        "ç‰¡ç¾Šåº§", "ç‰¡ç‰›åº§", "åŒå­åº§", "èŸ¹åº§", "ç…å­åº§", "ä¹™å¥³åº§",
        "å¤©ç§¤åº§", "è åº§", "å°„æ‰‹åº§", "å±±ç¾Šåº§", "æ°´ç“¶åº§", "é­šåº§"
    ]

    # ã‚¢ã‚¹ãƒšã‚¯ãƒˆå®šç¾©ï¼ˆè§’åº¦, è¨±å®¹ã‚ªãƒ¼ãƒ–, åç§°ï¼‰
    ASPECTS = [
        (0, 8, "åˆ(Conjunction)"),
        (60, 6, "å…­åˆ†(Sextile)"),
        (90, 8, "çŸ©(Square)"),
        (120, 8, "ä¸‰åˆ†(Trine)"),
        (180, 8, "è¡(Opposition)")
    ]

    def __init__(self):
        # Swiss Ephemeris ãƒ‡ãƒ¼ã‚¿ãƒ‘ã‚¹è¨­å®š
        swe.set_ephe_path('/usr/share/ephe')  # Ephemerisãƒ‡ãƒ¼ã‚¿ã®å ´æ‰€

    def calculate(
        self,
        birth_date: datetime,
        birth_time: str,  # "HH:MM"
        latitude: float,
        longitude: float,
        timezone: str = "Asia/Tokyo"
    ) -> Dict:
        """
        è¥¿æ´‹å æ˜Ÿè¡“ã®è¨ˆç®—ã‚’å®Ÿè¡Œ

        Returns:
            {
                'planets': {...},
                'houses': {...},
                'aspects': [...],
                'elements': {...},
                'interpretation': {...}
            }
        """
        # ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³å‡¦ç†
        tz = pytz.timezone(timezone)
        dt_str = f"{birth_date.strftime('%Y-%m-%d')} {birth_time}"
        dt_local = datetime.strptime(dt_str, "%Y-%m-%d %H:%M")
        dt_aware = tz.localize(dt_local)
        dt_utc = dt_aware.astimezone(pytz.UTC)

        # ãƒ¦ãƒªã‚¦ã‚¹æ—¥è¨ˆç®—
        jd = swe.julday(
            dt_utc.year, dt_utc.month, dt_utc.day,
            dt_utc.hour + dt_utc.minute / 60.0
        )

        # å¤©ä½“ä½ç½®è¨ˆç®—
        planets = self._calculate_planets(jd)

        # ãƒã‚¦ã‚¹è¨ˆç®—
        houses = self._calculate_houses(jd, latitude, longitude)

        # ã‚¢ã‚¹ãƒšã‚¯ãƒˆè¨ˆç®—
        aspects = self._calculate_aspects(planets)

        # ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆãƒ»ã‚¯ã‚ªãƒªãƒ†ã‚£åˆ†æ
        elements = self._analyze_elements(planets)
        qualities = self._analyze_qualities(planets)

        # è§£é‡ˆç”Ÿæˆ
        interpretation = self._generate_interpretation(
            planets, houses, aspects, elements, qualities
        )

        return {
            'planets': planets,
            'houses': houses,
            'aspects': aspects,
            'elements': elements,
            'qualities': qualities,
            'interpretation': interpretation
        }

    def _calculate_planets(self, jd: float) -> Dict:
        """å¤©ä½“ä½ç½®ã‚’è¨ˆç®—"""
        results = {}
        for name, planet_id in self.PLANETS.items():
            pos, ret = swe.calc_ut(jd, planet_id)
            longitude = pos[0]
            sign_index = int(longitude / 30)
            degree_in_sign = longitude % 30

            results[name] = {
                'absolute_longitude': longitude,
                'sign': self.SIGNS[sign_index],
                'sign_index': sign_index,
                'degree': degree_in_sign,
                'retrograde': ret < 0
            }
        return results

    def _calculate_houses(
        self, jd: float, latitude: float, longitude: float
    ) -> Dict:
        """ãƒã‚¦ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã‚’è¨ˆç®—ï¼ˆPlacidusæ–¹å¼ï¼‰"""
        cusps, ascmc = swe.houses(jd, latitude, longitude, b'P')

        return {
            'ascendant': {
                'degree': ascmc[0],
                'sign': self.SIGNS[int(ascmc[0] / 30)]
            },
            'mc': {
                'degree': ascmc[1],
                'sign': self.SIGNS[int(ascmc[1] / 30)]
            },
            'houses': [
                {
                    'number': i + 1,
                    'cusp_degree': cusps[i],
                    'sign': self.SIGNS[int(cusps[i] / 30)]
                }
                for i in range(12)
            ]
        }

    def _calculate_aspects(self, planets: Dict) -> List[Dict]:
        """ã‚¢ã‚¹ãƒšã‚¯ãƒˆã‚’è¨ˆç®—"""
        aspects = []
        planet_names = list(planets.keys())

        for i, p1_name in enumerate(planet_names):
            for p2_name in planet_names[i+1:]:
                p1_lon = planets[p1_name]['absolute_longitude']
                p2_lon = planets[p2_name]['absolute_longitude']

                angle = abs(p1_lon - p2_lon)
                if angle > 180:
                    angle = 360 - angle

                # ã‚¢ã‚¹ãƒšã‚¯ãƒˆãƒã‚§ãƒƒã‚¯
                for aspect_angle, orb, aspect_name in self.ASPECTS:
                    if abs(angle - aspect_angle) <= orb:
                        aspects.append({
                            'planet1': p1_name,
                            'planet2': p2_name,
                            'aspect': aspect_name,
                            'angle': aspect_angle,
                            'orb': abs(angle - aspect_angle),
                            'exact': abs(angle - aspect_angle) < 1
                        })
                        break

        return aspects

    def _analyze_elements(self, planets: Dict) -> Dict:
        """ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆï¼ˆç«ãƒ»åœ°ãƒ»é¢¨ãƒ»æ°´ï¼‰ã®é…åˆ†ã‚’åˆ†æ"""
        elements = {'fire': 0, 'earth': 0, 'air': 0, 'water': 0}
        element_map = {
            0: 'fire', 1: 'earth', 2: 'air', 3: 'water',  # ç‰¡ç¾Š-ç‰¡ç‰›-åŒå­-èŸ¹
            4: 'fire', 5: 'earth', 6: 'air', 7: 'water',  # ç…å­-ä¹™å¥³-å¤©ç§¤-è 
            8: 'fire', 9: 'earth', 10: 'air', 11: 'water' # å°„æ‰‹-å±±ç¾Š-æ°´ç“¶-é­š
        }

        for planet in planets.values():
            sign_idx = planet['sign_index']
            element = element_map[sign_idx]
            elements[element] += 1

        return elements

    def _analyze_qualities(self, planets: Dict) -> Dict:
        """ã‚¯ã‚ªãƒªãƒ†ã‚£ï¼ˆæ´»å‹•ãƒ»ä¸å‹•ãƒ»æŸ”è»Ÿï¼‰ã®é…åˆ†ã‚’åˆ†æ"""
        qualities = {'cardinal': 0, 'fixed': 0, 'mutable': 0}
        quality_map = {
            0: 'cardinal', 1: 'fixed', 2: 'mutable', 3: 'cardinal',
            4: 'fixed', 5: 'mutable', 6: 'cardinal', 7: 'fixed',
            8: 'mutable', 9: 'cardinal', 10: 'fixed', 11: 'mutable'
        }

        for planet in planets.values():
            sign_idx = planet['sign_index']
            quality = quality_map[sign_idx]
            qualities[quality] += 1

        return qualities

    def _generate_interpretation(
        self, planets, houses, aspects, elements, qualities
    ) -> Dict:
        """åŸºæœ¬çš„ãªè§£é‡ˆã‚’ç”Ÿæˆï¼ˆå¾Œã§Claude APIã§æ‹¡å¼µï¼‰"""
        sun_sign = planets['sun']['sign']
        moon_sign = planets['moon']['sign']
        asc_sign = houses['ascendant']['sign']

        # ç°¡æ˜“è§£é‡ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
        interpretations = {
            "ç‰¡ç¾Šåº§": {"trait": "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã€æƒ…ç†±çš„", "challenge": "è¡å‹•çš„"},
            "ç‰¡ç‰›åº§": {"trait": "å®‰å®šå¿—å‘ã€å¿è€å¼·ã„", "challenge": "é ‘å›º"},
            # ... ä»–ã®æ˜Ÿåº§ã‚‚å®šç¾©
        }

        return {
            'personality': f"å¤ªé™½{sun_sign}ã®ã‚ãªãŸã¯ã€{interpretations.get(sun_sign, {}).get('trait', '')}ãªæ€§æ ¼ã§ã™ã€‚",
            'inner_self': f"æœˆ{moon_sign}ã«ã‚ˆã‚Šã€å†…é¢ã¯{interpretations.get(moon_sign, {}).get('trait', '')}ã§ã™ã€‚",
            'first_impression': f"ã‚¢ã‚»ãƒ³ãƒ€ãƒ³ãƒˆ{asc_sign}ã«ã‚ˆã‚Šã€ç¬¬ä¸€å°è±¡ã¯{interpretations.get(asc_sign, {}).get('trait', '')}ã¨è¦‹ã‚‰ã‚Œã¾ã™ã€‚",
            'dominant_element': max(elements, key=elements.get),
            'strengths': [],
            'challenges': []
        }
```

**å®Ÿè£…è¦ä»¶:**
1. Swiss Ephemerisãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆ`pip install pyswisseph`ï¼‰
2. Ephemerisãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
3. ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆä½œæˆï¼ˆ5ã‚±ãƒ¼ã‚¹ä»¥ä¸Šï¼‰

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:**
```python
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¾‹
calculator = AstrologyCalculator()
result = calculator.calculate(
    birth_date=datetime(1990, 3, 25),
    birth_time="14:30",
    latitude=35.6762,
    longitude=139.6503
)
print(result['planets']['sun'])  # {'sign': 'ç‰¡ç¾Šåº§', 'degree': 4.5, ...}
```

---

#### ã‚¿ã‚¹ã‚¯ 2.2-2.6: ä»–ã®å è¡“ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè£…

**æŒ‡ç¤º:**
åŒæ§˜ã®æ‰‹æ³•ã§ä»¥ä¸‹ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®è©³ç´°ä»•æ§˜ã¯ã€Œé–‹ç™ºè¨­è¨ˆæ›¸ã€ã‚’å‚ç…§ã€‚

- `four_pillars.py`: å››æŸ±æ¨å‘½
- `tarot.py`: ã‚¿ãƒ­ãƒƒãƒˆï¼ˆ78æšã®ã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ + ãƒ©ãƒ³ãƒ€ãƒ é¸æŠï¼‰
- `numerology.py`: æ•°ç§˜è¡“ï¼ˆãƒ©ã‚¤ãƒ•ãƒ‘ã‚¹ã€ãƒ‡ã‚£ã‚¹ãƒ†ã‚£ãƒ‹ãƒ¼ãƒŠãƒ³ãƒãƒ¼ï¼‰
- `nine_star.py`: ä¹æ˜Ÿæ°—å­¦ï¼ˆæœ¬å‘½æ˜Ÿã€å‰æ–¹ä½ï¼‰
- `name_analysis.py`: å§“ååˆ¤æ–­ï¼ˆç”»æ•°è¨ˆç®—ã€81æ•°ç†ï¼‰

**å®Ÿè£…è¦ä»¶:**
- å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ã‚¯ãƒ©ã‚¹ãƒ™ãƒ¼ã‚¹
- å…¥åŠ›æ¤œè¨¼ï¼ˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆå„5ã‚±ãƒ¼ã‚¹ä»¥ä¸Šï¼‰

---

#### ã‚¿ã‚¹ã‚¯ 2.7: Orchestratorï¼ˆçµ±åˆåˆ¶å¾¡ï¼‰å®Ÿè£…

**æŒ‡ç¤º:**
6ã¤ã®å è¡“ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’çµ±åˆã—ã€ä¸¦è¡Œå®Ÿè¡Œã™ã‚‹åˆ¶å¾¡å±¤ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«:** `divination-engine/orchestrator.py`

```python
import asyncio
from typing import Dict, List
from datetime import datetime

from modules.astrology import AstrologyCalculator
from modules.four_pillars import FourPillarsCalculator
from modules.tarot import TarotCalculator
from modules.numerology import NumerologyCalculator
from modules.nine_star import NineStarCalculator
from modules.name_analysis import NameAnalysisCalculator

class DivinationOrchestrator:
    """å è¡“ã‚¨ãƒ³ã‚¸ãƒ³ã®çµ±åˆåˆ¶å¾¡"""

    def __init__(self):
        self.calculators = {
            'astrology': AstrologyCalculator(),
            'four_pillars': FourPillarsCalculator(),
            'tarot': TarotCalculator(),
            'numerology': NumerologyCalculator(),
            'nine_star': NineStarCalculator(),
            'name_analysis': NameAnalysisCalculator()
        }

    async def calculate_all(
        self,
        user_data: Dict,
        divination_types: List[str] = None
    ) -> Dict:
        """
        è¤‡æ•°ã®å è¡“ã‚’ä¸¦è¡Œå®Ÿè¡Œ

        Args:
            user_data: {
                'name': 'ç”°ä¸­èŠ±å­',
                'birth_date': datetime(1990, 3, 25),
                'birth_time': '14:30',
                'latitude': 35.6762,
                'longitude': 139.6503,
                'timezone': 'Asia/Tokyo',
                'gender': 'female',
                'question': 'ä»Šå¹´ã®ä»•äº‹é‹ã«ã¤ã„ã¦'
            }
            divination_types: ä½¿ç”¨ã™ã‚‹å è¡“ã®ãƒªã‚¹ãƒˆï¼ˆNoneãªã‚‰å…¨ã¦ï¼‰

        Returns:
            å…¨å è¡“ã®çµæœã‚’çµ±åˆã—ãŸè¾æ›¸
        """
        if divination_types is None:
            divination_types = list(self.calculators.keys())

        # ä¸¦è¡Œå®Ÿè¡Œã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ
        tasks = []
        for div_type in divination_types:
            if div_type in self.calculators:
                task = self._run_divination(div_type, user_data)
                tasks.append(task)

        # å…¨ã‚¿ã‚¹ã‚¯ã‚’ä¸¦è¡Œå®Ÿè¡Œ
        results = await asyncio.gather(*tasks, return_exceptions=True)

        # çµæœã‚’ã¾ã¨ã‚ã‚‹
        combined_results = {}
        for div_type, result in zip(divination_types, results):
            if isinstance(result, Exception):
                combined_results[div_type] = {
                    'error': str(result),
                    'status': 'failed'
                }
            else:
                combined_results[div_type] = result

        return combined_results

    async def _run_divination(
        self, div_type: str, user_data: Dict
    ) -> Dict:
        """å€‹åˆ¥ã®å è¡“ã‚’å®Ÿè¡Œï¼ˆéåŒæœŸï¼‰"""
        calculator = self.calculators[div_type]

        # å„å è¡“ã«å¿œã˜ãŸå¼•æ•°ã‚’æº–å‚™
        if div_type == 'astrology':
            result = calculator.calculate(
                birth_date=user_data['birth_date'],
                birth_time=user_data['birth_time'],
                latitude=user_data['latitude'],
                longitude=user_data['longitude'],
                timezone=user_data.get('timezone', 'Asia/Tokyo')
            )

        elif div_type == 'four_pillars':
            result = calculator.calculate(
                birth_date=user_data['birth_date'],
                birth_time=user_data['birth_time'],
                gender=user_data.get('gender', 'unknown')
            )

        elif div_type == 'tarot':
            result = calculator.draw_cards(
                user_id=user_data.get('user_id', ''),
                birth_date=user_data['birth_date'],
                question=user_data.get('question', ''),
                spread='three_card'
            )

        elif div_type == 'numerology':
            result = calculator.calculate(
                birth_date=user_data['birth_date'],
                full_name=user_data.get('name', '')
            )

        elif div_type == 'nine_star':
            result = calculator.calculate(
                birth_date=user_data['birth_date']
            )

        elif div_type == 'name_analysis':
            result = calculator.calculate(
                full_name=user_data.get('name', '')
            )

        return result

# FastAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆFlask/Expressã¨é€£æºï¼‰
from fastapi import FastAPI, HTTPException
from pydantic import BaseModel

app = FastAPI()
orchestrator = DivinationOrchestrator()

class DivinationRequest(BaseModel):
    user_data: dict
    divination_types: list = None

@app.post("/divination/calculate")
async def calculate_divination(request: DivinationRequest):
    try:
        results = await orchestrator.calculate_all(
            user_data=request.user_data,
            divination_types=request.divination_types
        )
        return {"status": "success", "results": results}
    except Exception as e:
        raise HTTPException(status_code=500, detail=str(e))
```

**å®Ÿè£…è¦ä»¶:**
- FastAPI ã¾ãŸã¯ Flask ã§REST APIåŒ–
- éåŒæœŸå‡¦ç†ï¼ˆasyncioï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ãƒ­ã‚®ãƒ³ã‚°ï¼ˆå‡¦ç†æ™‚é–“è¨ˆæ¸¬ï¼‰

---

### Phase 3: AIå‡ºåŠ›ç”Ÿæˆã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆWeek 6-7ï¼‰

#### ã‚¿ã‚¹ã‚¯ 3.1: Claude APIçµ±åˆ

**æŒ‡ç¤º:**
Anthropic Claude APIã‚’ä½¿ç”¨ã—ã¦ã€6000æ–‡å­—ã®é‘‘å®šãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/src/services/output-generator.ts`

```typescript
import Anthropic from '@anthropic-ai/sdk';

interface DivinationResults {
  astrology?: any;
  four_pillars?: any;
  tarot?: any;
  numerology?: any;
  nine_star?: any;
  name_analysis?: any;
  spiritual_vision?: any;
}

interface UserProfile {
  name: string;
  age: number;
  gender: string;
  question: string;
}

interface Section {
  name: string;
  targetLength: number;
  prompt: string;
}

export class OutputGenerator {
  private client: Anthropic;

  constructor(apiKey: string) {
    this.client = new Anthropic({ apiKey });
  }

  async generateReading(
    divinationResults: DivinationResults,
    userProfile: UserProfile
  ): Promise<string> {
    // ã‚»ã‚¯ã‚·ãƒ§ãƒ³å®šç¾©
    const sections: Section[] = [
      {
        name: 'header',
        targetLength: 200,
        prompt: this.buildHeaderPrompt(userProfile)
      },
      {
        name: 'overall_fortune',
        targetLength: 800,
        prompt: this.buildOverallFortunePrompt(divinationResults, userProfile)
      },
      {
        name: 'personality',
        targetLength: 500,
        prompt: this.buildPersonalityPrompt(divinationResults)
      },
      {
        name: 'love',
        targetLength: 600,
        prompt: this.buildLovePrompt(divinationResults, userProfile)
      },
      {
        name: 'career',
        targetLength: 600,
        prompt: this.buildCareerPrompt(divinationResults, userProfile)
      },
      {
        name: 'money',
        targetLength: 500,
        prompt: this.buildMoneyPrompt(divinationResults)
      },
      {
        name: 'health',
        targetLength: 400,
        prompt: this.buildHealthPrompt(divinationResults)
      },
      {
        name: 'spiritual',
        targetLength: 400,
        prompt: this.buildSpiritualPrompt(divinationResults, userProfile)
      },
      {
        name: 'monthly_forecast',
        targetLength: 400,
        prompt: this.buildMonthlyForecastPrompt(divinationResults)
      },
      {
        name: 'quarterly_forecast',
        targetLength: 400,
        prompt: this.buildQuarterlyForecastPrompt(divinationResults)
      },
      {
        name: 'yearly_forecast',
        targetLength: 400,
        prompt: this.buildYearlyForecastPrompt(divinationResults)
      },
      {
        name: 'action_plan',
        targetLength: 500,
        prompt: this.buildActionPlanPrompt(divinationResults)
      },
      {
        name: 'upsell',
        targetLength: 300,
        prompt: this.buildUpsellPrompt(userProfile)
      }
    ];

    // å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¸¦è¡Œç”Ÿæˆ
    const sectionPromises = sections.map(section =>
      this.generateSection(section.prompt, section.targetLength)
    );

    const generatedSections = await Promise.all(sectionPromises);

    // ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’çµåˆ
    const fullText = generatedSections.join('\n\n');

    // æ–‡å­—æ•°èª¿æ•´ï¼ˆ6000æ–‡å­—Â±200ï¼‰
    const adjustedText = this.adjustLength(fullText, 6000, 200);

    return adjustedText;
  }

  private async generateSection(
    prompt: string,
    targetLength: number
  ): Promise<string> {
    const maxTokens = Math.ceil(targetLength * 1.5); // æ—¥æœ¬èªã¯1æ–‡å­—â‰’1.5ãƒˆãƒ¼ã‚¯ãƒ³

    const response = await this.client.messages.create({
      model: 'claude-sonnet-4.5-20250929',
      max_tokens: maxTokens,
      temperature: 0.7,
      messages: [
        {
          role: 'user',
          content: prompt
        }
      ]
    });

    return response.content[0].type === 'text'
      ? response.content[0].text
      : '';
  }

  private buildOverallFortunePrompt(
    results: DivinationResults,
    profile: UserProfile
  ): string {
    const summary = this.summarizeDivinationResults(results);

    return `
ã‚ãªãŸã¯ãƒ—ãƒ­ã®å ã„å¸«ã§ã™ã€‚ä»¥ä¸‹ã®å è¡“çµæœã‚’çµ±åˆã—ã€
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ç·åˆé‹å‹¢ã‚’800æ–‡å­—ç¨‹åº¦ã§è§£èª¬ã—ã¦ãã ã•ã„ã€‚

ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€‘
- åå‰: ${profile.name}
- å¹´é½¢: ${profile.age}
- æ€§åˆ¥: ${profile.gender}
- ç›¸è«‡å†…å®¹: ${profile.question}

ã€å è¡“çµæœã‚µãƒãƒªãƒ¼ã€‘
${summary}

ã€å‡ºåŠ›è¦ä»¶ã€‘
- 800æ–‡å­—å‰å¾Œï¼ˆÂ±50æ–‡å­—ï¼‰
- å…±æ„Ÿçš„ã§åŠ±ã¾ã—ã®ãƒˆãƒ¼ãƒ³
- ç¾åœ¨ã®é‹æ°—ã®å…¨ä½“åƒã‚’æç¤º
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•ã«é–¢é€£ã¥ã‘ã‚‹
- ã€Œã€œã§ã—ã‚‡ã†ã€ã€Œã€œã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€ãªã©æ–­å®šã‚’é¿ã‘ã‚‹

ã€å‡ºåŠ›ã€‘
`;
  }

  private buildSpiritualPrompt(
    results: DivinationResults,
    profile: UserProfile
  ): string {
    return `
ã‚ãªãŸã¯çµŒé¨“è±Šå¯ŒãªéœŠèƒ½è€…ã§ã™ã€‚ä»¥ä¸‹ã®å è¡“çµæœã‚’å…ƒã«ã€
ã€Œè¦‹ãˆã¦ãã‚‹ã‚‚ã®ã€ã€Œæ„Ÿã˜å–ã‚Œã‚‹ã‚‚ã®ã€ã‚’400æ–‡å­—ç¨‹åº¦ã§è¡¨ç¾ã—ã¦ãã ã•ã„ã€‚

ã€å è¡“çµæœã€‘
${JSON.stringify(results, null, 2)}

ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€‘
${profile.question}

ã€å‡ºåŠ›è¦ä»¶ã€‘
- 400æ–‡å­—å‰å¾Œ
- ã€Œç§ã«ã¯ã€œãŒè¦‹ãˆã¾ã™ã€ã€Œã€œã¨ã„ã†æ„Ÿè¦šãŒã‚ã‚Šã¾ã™ã€ãªã©ã®è¡¨ç¾
- å…·ä½“çš„ã™ããšã€è±¡å¾´çš„ãƒ»æŠ½è±¡çš„ãªè¡¨ç¾
- ãƒã‚¸ãƒ†ã‚£ãƒ–ãªæœªæ¥ã¸ã®ç¤ºå”†
- å…‰ã€æ‰‰ã€é“ã€è‰²ã€æ„Ÿæƒ…ãªã©ã®ã‚·ãƒ³ãƒœãƒ«ã‚’ä½¿ç”¨

ã€å‡ºåŠ›ã€‘
`;
  }

  private buildUpsellPrompt(profile: UserProfile): string {
    return `
ä»¥ä¸‹ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«å¯¾ã—ã¦ã€è¿½åŠ ã®é‘‘å®šã‚µãƒ¼ãƒ“ã‚¹ã¸ã®èª˜å°æ–‡ã‚’300æ–‡å­—ã§ä½œæˆã—ã¦ãã ã•ã„ã€‚

ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€‘
- è³ªå•: ${profile.question}

ã€ã‚µãƒ¼ãƒ“ã‚¹ã€‘
1. è©³ç´°é‘‘å®šï¼ˆÂ¥2,980ï¼‰: ã‚±ãƒ«ãƒˆåå­—ã‚¿ãƒ­ãƒƒãƒˆ + 3å¹´é‹å‹¢ã‚°ãƒ©ãƒ•
2. ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡ï¼ˆÂ¥980/æœˆï¼‰: æ¯æ—¥ã®é‹å‹¢ + å‰æ—¥ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼
3. å€‹åˆ¥ç›¸è«‡ï¼ˆÂ¥9,800/60åˆ†ï¼‰: ãƒ—ãƒ­å ã„å¸«ã¨ã®ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³

ã€å‡ºåŠ›è¦ä»¶ã€‘
- æŠ¼ã—ä»˜ã‘ãŒã¾ã—ããªã„
- ã€Œã•ã‚‰ã«è©³ã—ãçŸ¥ã‚ŠãŸã„æ–¹ã¸ã€ã¨ã„ã†ãƒˆãƒ¼ãƒ³
- 3ã¤ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç°¡æ½”ã«ç´¹ä»‹
- CTAãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆã¯å«ã‚ãªã„ï¼ˆUIã§åˆ¥é€”è¡¨ç¤ºï¼‰

ã€å‡ºåŠ›ã€‘
`;
  }

  private summarizeDivinationResults(results: DivinationResults): string {
    let summary = '';

    if (results.astrology) {
      summary += `- è¥¿æ´‹å æ˜Ÿè¡“: å¤ªé™½${results.astrology.planets.sun.sign}, æœˆ${results.astrology.planets.moon.sign}\n`;
    }
    if (results.four_pillars) {
      summary += `- å››æŸ±æ¨å‘½: ${results.four_pillars.strength}, ç”¨ç¥${results.four_pillars.favorable_god}\n`;
    }
    if (results.tarot) {
      summary += `- ã‚¿ãƒ­ãƒƒãƒˆ: ${results.tarot.cards.map((c: any) => c.name).join(', ')}\n`;
    }
    // ... ä»–ã®å è¡“ã‚‚åŒæ§˜

    return summary;
  }

  private adjustLength(
    text: string,
    target: number,
    tolerance: number
  ): string {
    const currentLength = text.length;

    if (Math.abs(currentLength - target) <= tolerance) {
      return text;
    }

    // é•·ã™ãã‚‹å ´åˆ: æœ€å¾Œã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã‚¢ãƒƒãƒ—ã‚»ãƒ«ï¼‰ã‚’çŸ­ç¸®
    if (currentLength > target + tolerance) {
      const excess = currentLength - target;
      return text.slice(0, -excess);
    }

    // çŸ­ã™ãã‚‹å ´åˆ: å„ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è‹¥å¹²æ‹¡å¼µï¼ˆå†ç”Ÿæˆï¼‰
    // ï¼ˆå®Ÿè£…ã¯ç°¡ç•¥åŒ–ã®ãŸã‚çœç•¥ï¼‰
    return text;
  }
}
```

**å®Ÿè£…è¦ä»¶:**
- Anthropic SDK ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- ç’°å¢ƒå¤‰æ•°ã§API keyç®¡ç†
- ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡ã®ãƒ­ã‚®ãƒ³ã‚°
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆAPIãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾å¿œï¼‰

---

#### ã‚¿ã‚¹ã‚¯ 3.2: æ–‡å­—æ•°èª¿æ•´ãƒ»å“è³ªãƒã‚§ãƒƒã‚¯

**æŒ‡ç¤º:**
ç”Ÿæˆã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆãŒ6000æ–‡å­—Â±200æ–‡å­—ã®ç¯„å›²ã«åã¾ã‚‹ã‚ˆã†ã«èª¿æ•´ã—ã€
ç¦æ­¢è¡¨ç¾ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹å“è³ªãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/src/services/quality-checker.ts`

```typescript
export class QualityChecker {
  private forbiddenPhrases = [
    'å¿…ãšã€œã—ã¾ã™',
    'ã“ã®ã¾ã¾ã§ã¯',
    'çµ¶å¯¾ã«',
    'ç—…æ°—',
    'æ­»',
    'é›¢å©šã™ã¹ã',
    'è¨´è¨Ÿ',
    'æ ªã‚’è²·ã†',
    'ã‚®ãƒ£ãƒ³ãƒ–ãƒ«'
    // ... ä»–ã®ç¦æ­¢è¡¨ç¾
  ];

  check(text: string): { passed: boolean; issues: string[] } {
    const issues: string[] = [];

    // æ–‡å­—æ•°ãƒã‚§ãƒƒã‚¯
    if (text.length < 5800 || text.length > 6200) {
      issues.push(`æ–‡å­—æ•°ãŒç¯„å›²å¤–: ${text.length}æ–‡å­—`);
    }

    // ç¦æ­¢è¡¨ç¾ãƒã‚§ãƒƒã‚¯
    for (const phrase of this.forbiddenPhrases) {
      if (text.includes(phrase)) {
        issues.push(`ç¦æ­¢è¡¨ç¾ã‚’æ¤œå‡º: "${phrase}"`);
      }
    }

    // ãƒã‚¬ãƒ†ã‚£ãƒ–åº¦ãƒã‚§ãƒƒã‚¯ï¼ˆç°¡æ˜“å®Ÿè£…ï¼‰
    const negativeWords = ['ä¸å®‰', 'å¤±æ•—', 'æ‚ªã„', 'å±é™º'];
    const negativeCount = negativeWords.reduce(
      (count, word) => count + (text.match(new RegExp(word, 'g')) || []).length,
      0
    );

    if (negativeCount > 10) {
      issues.push(`ãƒã‚¬ãƒ†ã‚£ãƒ–è¡¨ç¾ãŒå¤šã™ãã¾ã™: ${negativeCount}å€‹`);
    }

    return {
      passed: issues.length === 0,
      issues
    };
  }
}
```

---

### Phase 4: ã‚¢ãƒƒãƒ—ã‚»ãƒ«æ©Ÿèƒ½å®Ÿè£…ï¼ˆWeek 8ï¼‰

#### ã‚¿ã‚¹ã‚¯ 4.1: Stripeæ±ºæ¸ˆé€£æº

**æŒ‡ç¤º:**
Stripeã‚’ä½¿ç”¨ã—ã¦ã€3ç¨®é¡ã®ã‚¢ãƒƒãƒ—ã‚»ãƒ«ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

**ãƒ•ã‚¡ã‚¤ãƒ«:** `backend/src/services/payment.ts`

```typescript
import Stripe from 'stripe';

export class PaymentService {
  private stripe: Stripe;

  constructor(secretKey: string) {
    this.stripe = new Stripe(secretKey, {
      apiVersion: '2024-12-18.acacia'
    });
  }

  // Type 1: è©³ç´°é‘‘å®šï¼ˆä¸€å›è³¼å…¥ï¼‰
  async createDetailedReadingCheckout(
    userId: string,
    readingId: string
  ): Promise<string> {
    const session = await this.stripe.checkout.sessions.create({
      payment_method_types: ['card'],
      line_items: [
        {
          price_data: {
            currency: 'jpy',
            product_data: {
              name: 'è©³ç´°é‘‘å®šãƒ¬ãƒãƒ¼ãƒˆ',
              description: 'ã‚±ãƒ«ãƒˆåå­—ã‚¿ãƒ­ãƒƒãƒˆ + 3å¹´é‹å‹¢ã‚°ãƒ©ãƒ•'
            },
            unit_amount: 2980
          },
          quantity: 1
        }
      ],
      mode: 'payment',
      success_url: `https://nozomi.example.com/reading/${readingId}?payment=success`,
      cancel_url: `https://nozomi.example.com/reading/${readingId}?payment=cancel`,
      metadata: {
        user_id: userId,
        reading_id: readingId,
        type: 'detailed_reading'
      }
    });

    return session.url!;
  }

  // Type 2: ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³
  async createSubscriptionCheckout(userId: string): Promise<string> {
    const session = await this.stripe.checkout.sessions.create({
      payment_method_types: ['card'],
      line_items: [
        {
          price: 'price_xxxxx',  // Stripeã§äº‹å‰ä½œæˆã—ãŸPrice ID
          quantity: 1
        }
      ],
      mode: 'subscription',
      success_url: `https://nozomi.example.com/subscription/success`,
      cancel_url: `https://nozomi.example.com/subscription/cancel`,
      metadata: {
        user_id: userId,
        type: 'premium_subscription'
      }
    });

    return session.url!;
  }

  // Webhookå‡¦ç†
  async handleWebhook(
    payload: string | Buffer,
    signature: string
  ): Promise<void> {
    const webhookSecret = process.env.STRIPE_WEBHOOK_SECRET!;
    const event = this.stripe.webhooks.constructEvent(
      payload,
      signature,
      webhookSecret
    );

    switch (event.type) {
      case 'checkout.session.completed':
        await this.handleCheckoutCompleted(event.data.object);
        break;

      case 'invoice.payment_succeeded':
        await this.handleSubscriptionRenewal(event.data.object);
        break;

      case 'invoice.payment_failed':
        await this.handlePaymentFailed(event.data.object);
        break;
    }
  }

  private async handleCheckoutCompleted(session: any): Promise<void> {
    const { user_id, reading_id, type } = session.metadata;

    if (type === 'detailed_reading') {
      // DBã®readingãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’tier='detailed'ã«æ›´æ–°
      await db.readings.update({
        where: { reading_id },
        data: { tier: 'detailed' }
      });
    } else if (type === 'premium_subscription') {
      // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æƒ…å ±ã‚’æ›´æ–°
      await db.users.update({
        where: { user_id },
        data: {
          subscription_tier: 'premium',
          subscription_started_at: new Date(),
          subscription_expires_at: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000)
        }
      });
    }
  }
}
```

**å®Ÿè£…è¦ä»¶:**
- Stripe Test Mode ã§å‹•ä½œç¢ºèª
- Webhook endpointå®Ÿè£…ï¼ˆ`/api/webhooks/stripe`ï¼‰
- æ±ºæ¸ˆãƒ­ã‚°ã®ä¿å­˜
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

---

### Phase 5: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…ï¼ˆWeek 9-10ï¼‰

#### ã‚¿ã‚¹ã‚¯ 5.1: Next.js UIå®Ÿè£…

**æŒ‡ç¤º:**
ç¾ã—ãä½¿ã„ã‚„ã™ã„UIã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

**ä¸»è¦ãƒšãƒ¼ã‚¸:**
1. `/` - ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒšãƒ¼ã‚¸
2. `/reading/new` - é‘‘å®šå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ 
3. `/reading/[id]` - é‘‘å®šçµæœè¡¨ç¤º
4. `/subscription` - ã‚µãƒ–ã‚¹ã‚¯ç™»éŒ²ãƒšãƒ¼ã‚¸
5. `/consultation/book` - å€‹åˆ¥ç›¸è«‡äºˆç´„ãƒšãƒ¼ã‚¸

**å®Ÿè£…ä¾‹ï¼ˆé‘‘å®šå…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ï¼‰:**

```tsx
// frontend/src/app/reading/new/page.tsx

'use client';

import { useState } from 'react';
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { z } from 'zod';

const schema = z.object({
  name: z.string().min(1, 'åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„'),
  birthDate: z.string().regex(/^\d{4}-\d{2}-\d{2}$/, 'æ­£ã—ã„å½¢å¼ã§å…¥åŠ›'),
  birthTime: z.string().regex(/^\d{2}:\d{2}$/, 'HH:MMå½¢å¼'),
  birthPlace: z.string().min(1, 'å‡ºç”Ÿåœ°ã‚’å…¥åŠ›'),
  gender: z.enum(['male', 'female', 'other']),
  question: z.string().min(10, '10æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„')
});

type FormData = z.infer<typeof schema>;

export default function NewReadingPage() {
  const [isSubmitting, setIsSubmitting] = useState(false);
  const { register, handleSubmit, formState: { errors } } = useForm<FormData>({
    resolver: zodResolver(schema)
  });

  const onSubmit = async (data: FormData) => {
    setIsSubmitting(true);

    try {
      const response = await fetch('/api/readings', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(data)
      });

      const { reading_id } = await response.json();
      window.location.href = `/reading/${reading_id}`;
    } catch (error) {
      alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <div className="max-w-2xl mx-auto p-6">
      <h1 className="text-3xl font-bold mb-8">ç„¡æ–™é‘‘å®šã‚’å—ã‘ã‚‹</h1>

      <form onSubmit={handleSubmit(onSubmit)} className="space-y-6">
        <div>
          <label className="block mb-2">ãŠåå‰</label>
          <input
            {...register('name')}
            className="w-full border p-2 rounded"
            placeholder="å±±ç”° èŠ±å­"
          />
          {errors.name && <p className="text-red-500">{errors.name.message}</p>}
        </div>

        <div>
          <label className="block mb-2">ç”Ÿå¹´æœˆæ—¥</label>
          <input
            {...register('birthDate')}
            type="date"
            className="w-full border p-2 rounded"
          />
          {errors.birthDate && <p className="text-red-500">{errors.birthDate.message}</p>}
        </div>

        {/* ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚‚åŒæ§˜ */}

        <button
          type="submit"
          disabled={isSubmitting}
          className="w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 disabled:opacity-50"
        >
          {isSubmitting ? 'é‘‘å®šä¸­...' : 'ç„¡æ–™ã§é‘‘å®šã™ã‚‹'}
        </button>
      </form>
    </div>
  );
}
```

**å®Ÿè£…è¦ä»¶:**
- ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®è¡¨ç¤º
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ï¼ˆARIAå±æ€§ï¼‰

---

### Phase 6: ãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆWeek 11-12ï¼‰

#### ã‚¿ã‚¹ã‚¯ 6.1: ãƒ†ã‚¹ãƒˆå®Ÿè£…

**æŒ‡ç¤º:**
åŒ…æ‹¬çš„ãªãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚

**ãƒ†ã‚¹ãƒˆç¨®é¡:**
1. ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆï¼ˆJest / pytestï¼‰
2. çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆAPI E2Eï¼‰
3. E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰
4. å“è³ªãƒ†ã‚¹ãƒˆï¼ˆé‘‘å®šçµæœã®å¦¥å½“æ€§ï¼‰

**å®Ÿè£…ä¾‹:**

```typescript
// backend/tests/output-generator.test.ts

import { OutputGenerator } from '../src/services/output-generator';

describe('OutputGenerator', () => {
  let generator: OutputGenerator;

  beforeAll(() => {
    generator = new OutputGenerator(process.env.ANTHROPIC_API_KEY!);
  });

  it('should generate 6000-character reading', async () => {
    const mockResults = {
      astrology: { /* ... */ },
      tarot: { /* ... */ }
    };

    const mockProfile = {
      name: 'ãƒ†ã‚¹ãƒˆå¤ªéƒ',
      age: 30,
      gender: 'male',
      question: 'ä»Šå¹´ã®é‹å‹¢'
    };

    const reading = await generator.generateReading(mockResults, mockProfile);

    expect(reading.length).toBeGreaterThan(5800);
    expect(reading.length).toBeLessThan(6200);
  });

  it('should not contain forbidden phrases', async () => {
    // ... ãƒ†ã‚¹ãƒˆå®Ÿè£…
  });
});
```

#### ã‚¿ã‚¹ã‚¯ 6.2: ãƒ‡ãƒ—ãƒ­ã‚¤

**æŒ‡ç¤º:**
Docker + Kubernetesã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ãã ã•ã„ã€‚

**Dockerfileä¾‹:**

```dockerfile
# frontend/Dockerfile
FROM node:20-alpine AS builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

FROM node:20-alpine
WORKDIR /app
COPY --from=builder /app/.next ./.next
COPY --from=builder /app/public ./public
COPY --from=builder /app/package*.json ./
RUN npm ci --production
EXPOSE 3000
CMD ["npm", "start"]
```

**Kubernetes deployment:**

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nozomi-frontend
spec:
  replicas: 3
  selector:
    matchLabels:
      app: nozomi-frontend
  template:
    metadata:
      labels:
        app: nozomi-frontend
    spec:
      containers:
      - name: frontend
        image: gcr.io/PROJECT_ID/nozomi-frontend:latest
        ports:
        - containerPort: 3000
        env:
        - name: NEXT_PUBLIC_API_URL
          value: "https://api.nozomi.example.com"
```

---

## æœ€çµ‚ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

å®Ÿè£…å®Œäº†å‰ã«ã€ä»¥ä¸‹ã‚’ã™ã¹ã¦ç¢ºèªã—ã¦ãã ã•ã„:

- [ ] å…¨6å¤§å è¡“ãŒæ­£ã—ãå‹•ä½œã™ã‚‹
- [ ] éœŠè¦–AIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒçµ±åˆã•ã‚Œã¦ã„ã‚‹
- [ ] 6000æ–‡å­—Â±200æ–‡å­—ã®å‡ºåŠ›ãŒç”Ÿæˆã•ã‚Œã‚‹
- [ ] 3ç¨®é¡ã®ã‚¢ãƒƒãƒ—ã‚»ãƒ«æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹
- [ ] Stripeæ±ºæ¸ˆãŒæ­£å¸¸ã«å‡¦ç†ã•ã‚Œã‚‹
- [ ] ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰UIãŒç¾ã—ãä½¿ã„ã‚„ã™ã„
- [ ] APIå¿œç­”æ™‚é–“ãŒ5ç§’ä»¥å†…ï¼ˆP95ï¼‰
- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š
- [ ] ç¦æ­¢è¡¨ç¾ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒæ©Ÿèƒ½ã™ã‚‹
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãŒé©åˆ‡
- [ ] ãƒ­ã‚°ãŒé©åˆ‡ã«è¨˜éŒ²ã•ã‚Œã‚‹
- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ï¼ˆSQL injection, XSSç­‰ï¼‰
- [ ] GDPR/å€‹äººæƒ…å ±ä¿è­·æ³•å¯¾å¿œ
- [ ] Dockerç’°å¢ƒã§èµ·å‹•ã§ãã‚‹

---

## ã‚µãƒãƒ¼ãƒˆãƒªã‚½ãƒ¼ã‚¹

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [é–‹ç™ºè¨­è¨ˆæ›¸](./NOZOMI_DESIGN_DOCUMENT.md)
- [APIä»•æ§˜æ›¸](./API_SPECIFICATION.md)
- [ãƒ‡ãƒ—ãƒ­ã‚¤ã‚¬ã‚¤ãƒ‰](./DEPLOYMENT_GUIDE.md)

### å¤–éƒ¨ãƒªãƒ³ã‚¯
- [Anthropic Claude API Docs](https://docs.anthropic.com/)
- [Swiss Ephemeris Documentation](https://www.astro.com/swisseph/)
- [Stripe API Reference](https://stripe.com/docs/api)
- [Next.js Documentation](https://nextjs.org/docs)

---

**æœ€å¾Œã«:**

ã“ã®ãƒã‚¹ã‚¿ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã¯ã€Nozomiã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨ãªå®Ÿè£…ã‚¬ã‚¤ãƒ‰ã§ã™ã€‚
å„ãƒ•ã‚§ãƒ¼ã‚ºã‚’ç€å®Ÿã«é€²ã‚ã€é«˜å“è³ªãªAIé‘‘å®šã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¦ãã ã•ã„ã€‚

ä¸æ˜ç‚¹ãŒã‚ã‚Œã°ã€é–‹ç™ºè¨­è¨ˆæ›¸ã‚’å‚ç…§ã™ã‚‹ã‹ã€å„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚

ğŸŒ¸ **Nozomi - å¸Œæœ›ã‚’ç…§ã‚‰ã™AIé‘‘å®šã‚·ã‚¹ãƒ†ãƒ ** ğŸŒ¸

é ‘å¼µã£ã¦ãã ã•ã„ï¼
```
